(()=>{"use strict";function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function e(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var n=function(){function n(t,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),e(this,"_x",0),e(this,"_y",0),this._x=t,this._y=i}var i,r,o;return i=n,o=[{key:"random",value:function(){return new n(Math.random(),Math.random()).normalize()}},{key:"distance",value:function(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}}],(r=[{key:"x",get:function(){return this._x}},{key:"y",get:function(){return this._y}},{key:"sqrMagnitude",value:function(){return Math.pow(this.x,2)+Math.pow(this.y,2)}},{key:"magnitude",value:function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))}},{key:"normalize",value:function(){var t=this.magnitude();return new n(this.x/t,this.y/t)}},{key:"scale",value:function(t){return new n(this.x*t,this.y*t)}},{key:"add",value:function(t){return new n(this.x+t.x,this.y+t.y)}},{key:"rotate",value:function(t){var e=t*Math.PI/180;return new n(this.x*Math.cos(e)-Math.sin(e)*this.y,this.x*Math.sin(e)+this.y*Math.cos(e))}},{key:"toString",value:function(){return"Vector2(x: ".concat(this.x,", y: ").concat(this.y,")")}}])&&t(i.prototype,r),o&&t(i,o),n}();e(n,"ZERO",new n(0,0));const i=n;function r(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function o(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function a(t,e,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;e.ready&&(t.save(),t.translate(n.x,n.y),t.rotate(r*Math.PI/180),t.translate(-n.x,-n.y),t.drawImage(e.texture,n.x-i.x/2,n.y-i.y/2,i.x,i.y),t.restore())}var s=function(){function t(e,n){var i=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),o(this,"size",void 0),o(this,"el",void 0),o(this,"ready",!1),this.el=new Image,this.el.src=e,this.el.addEventListener("load",(function(){i.ready=!0}))}var e,n;return e=t,(n=[{key:"texture",get:function(){return this.el}}])&&r(e.prototype,n),t}();function u(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function l(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var h=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),l(this,"scaleX",void 0),l(this,"scaleY",void 0),this.scaleX=e,this.scaleY=n}var e,n;return e=t,(n=[{key:"translate",value:function(t){return new i(t.x*this.scaleX,t.y*this.scaleY)}},{key:"translateValueX",value:function(t){return t*this.scaleX}},{key:"translateValueY",value:function(t){return t*this.scaleY}}])&&u(e.prototype,n),t}();function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function f(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function d(t,e,n){return e&&f(t.prototype,e),n&&f(t,n),t}function y(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var v=function(){function t(){c(this,t),y(this,"particles",void 0),this.particles=[]}return d(t,[{key:"update",value:function(t,e){this.particles=this.particles.filter((function(n){return n.update(t,e),n.remainingTime>0}))}},{key:"add",value:function(t){this.particles.push(t)}}]),t}(),p=function(){function t(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10;c(this,t),y(this,"position",void 0),y(this,"_rate",.1),y(this,"_elapsed",0),y(this,"_count",10),y(this,"_container",void 0),y(this,"_particleGenerator",void 0),y(this,"_predicate",void 0),this._container=new v,this._particleGenerator=e,this._predicate=n,this._count=r,this._rate=i}return d(t,[{key:"draw",value:function(t,e,n){this._container.particles.forEach((function(i){i.draw(t,e,n)}))}},{key:"update",value:function(t,e){if(this._predicate(e)&&(this._elapsed+=t,this._elapsed>this._rate)){this._elapsed-=this._rate;for(var n=0;n<this._count;n++)this._container.add(new g(this.position,this._particleGenerator.velocity(e),this._particleGenerator.lifetime(e),this._particleGenerator.rotation(e),this._particleGenerator.texture(e),this._particleGenerator.size(e)))}this._container.update(t,e)}}]),t}(),g=function(){function t(e,n,i,r,o,a){c(this,t),y(this,"_center",void 0),y(this,"_direction",void 0),y(this,"_velocity",void 0),y(this,"_lifetime",void 0),y(this,"_rotation",void 0),y(this,"_elapsedLifetime",void 0),y(this,"_texture",void 0),y(this,"_size",void 0),this._center=e,this._velocity=n,this._lifetime=i,this._rotation=r,this._texture=o,this._size=a,this._elapsedLifetime=0}return d(t,[{key:"draw",value:function(t,e,n){t.globalAlpha=1-this._elapsedLifetime/this._lifetime,a(t,this._texture,n.translate(this._center),n.translate(this._size),this._rotation),t.globalAlpha=1}},{key:"velocity",get:function(){return this._velocity}},{key:"direction",get:function(){return this._direction}},{key:"center",get:function(){return this._center}},{key:"remainingTime",get:function(){return this._lifetime-this._elapsedLifetime}},{key:"update",value:function(t,e){this._elapsedLifetime+=t,this._center=this._center.add(this._velocity.scale(t))}}]),t}();function w(t,e,n){var r=new i(n.x-e.x,n.y-e.y),o=new i(e.x-t.center.x,e.y-t.center.y),a=-2*(r.x*o.x+r.y*o.y),s=2*(r.x*r.x+r.y*r.y),u=Math.sqrt(a*a-2*s*(o.x*o.x+o.y*o.y-t.radius*t.radius));if(isNaN(u))return!1;var l=(a-u)/s,h=(a+u)/s;return l<=1&&l>=0||h<=1&&h>=0}function m(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var _=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n;return e=t,(n=[{key:"gaussian",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6,e=0,n=0;n<t;n++)e+=Math.random();return e/t}}])&&m(e.prototype,n),t}());function b(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function x(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var k=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),x(this,"_center",void 0),x(this,"_radius",void 0),this._center=e,this._radius=n}var e,n;return e=t,(n=[{key:"center",get:function(){return this._center}},{key:"radius",get:function(){return this._radius}}])&&b(e.prototype,n),t}();function T(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function E(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function C(t,e,n){return e&&E(t.prototype,e),n&&E(t,n),t}function P(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var M=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;T(this,t),P(this,"_rotationOffset",void 0),P(this,"tex",new s("assets/Smoke.png",new i(32,32))),P(this,"_size",new i(.75,.75)),this._rotationOffset=e}return C(t,[{key:"texture",value:function(t){return this.tex}},{key:"size",value:function(t){return this._size}},{key:"velocity",value:function(t){var e=t.lander.rotationVector,n=100*_.gaussian(12)-50;return(e=e.rotate(n+this._rotationOffset)).scale(-5*_.gaussian(12))}},{key:"lifetime",value:function(t){return 5+_.gaussian(12)}},{key:"rotation",value:function(t){return 0}}]),t}(),O=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;T(this,t),P(this,"_rotationOffset",void 0),P(this,"tex",new s("assets/Fire.png",new i(32,32))),P(this,"_size",new i(1,1)),this._rotationOffset=e}return C(t,[{key:"texture",value:function(t){return this.tex}},{key:"size",value:function(t){return this._size}},{key:"velocity",value:function(t){var e=t.lander.rotationVector,n=360*Math.random();return(e=e.rotate(n)).scale(-20*_.gaussian(12))}},{key:"lifetime",value:function(t){return 5+_.gaussian(12)}},{key:"rotation",value:function(t){return 0}}]),t}(),S=function(){function t(e,n,r){var o=this;T(this,t),P(this,"size",void 0),P(this,"texture",void 0),P(this,"frozen",void 0),P(this,"thrustEmitter",void 0),P(this,"leftRotationEmitter",void 0),P(this,"rightRotationEmitter",void 0),P(this,"explosionEmitter",void 0),P(this,"_position",void 0),P(this,"_velocity",void 0),P(this,"_rotationVector",void 0),P(this,"_rotation",void 0),P(this,"_explosionCount",0),P(this,"_isExploding",void 0),P(this,"fuel",100),P(this,"crashed",!1),P(this,"thrusting",!1),P(this,"turningLeft",!1),P(this,"turningRight",!1),this.texture=n,this.size=r,this.frozen=!1,this._position=e,this._velocity=new i(0,0),this._rotationVector=new i(0,-1),this._rotation=0,this.thrustEmitter=new p(new M,(function(t){return t.lander.thrusting&&t.lander.fuel>0}),.05,10),this.leftRotationEmitter=new p(new M(90),(function(t){return t.lander.turningLeft&&t.lander.fuel>0}),.05,5),this.rightRotationEmitter=new p(new M(-90),(function(t){return t.lander.turningRight&&t.lander.fuel>0}),.05,5),this.explosionEmitter=new p(new O,(function(t){return o._isExploding}),.1,400),this.positionEmitters()}return C(t,[{key:"draw",value:function(t,e,n){e.lander.crashed||a(t,this.texture,n.translate(this._position),n.translate(this.size),this._rotation),this.thrustEmitter.draw(t,e,n),this.leftRotationEmitter.draw(t,e,n),this.rightRotationEmitter.draw(t,e,n),this.explosionEmitter.draw(t,e,n)}},{key:"debugDraw",value:function(t,e,n){t.beginPath(),t.strokeStyle="#ffffff";var r=n.translate(this._position);t.arc(r.x,r.y,n.translate(new i(4,0)).x,0,2*Math.PI),t.stroke();var o=n.translate(this._position),a=n.translate(this._rotationVector.scale(5));t.beginPath(),this._rotation%360<5&&this._rotation%360>-5?t.strokeStyle="#00ff00":t.strokeStyle="#ff0000",t.lineTo(o.x,o.y),t.lineTo(o.x+a.x,o.y+a.y),t.stroke();var s=n.translate(this._velocity.normalize().scale(5));t.beginPath(),this._velocity.sqrMagnitude()<4?t.strokeStyle="#0000ff":t.strokeStyle="#ff0000",t.lineTo(o.x,o.y),t.lineTo(o.x+s.x,o.y+s.y),t.stroke()}},{key:"positionEmitters",value:function(){this.thrustEmitter.position=this._position.add(this._rotationVector.scale(-3)),this.leftRotationEmitter.position=this._position.add(this._rotationVector.rotate(70).scale(-3.5)),this.rightRotationEmitter.position=this._position.add(this._rotationVector.rotate(-70).scale(-3.5)),this.explosionEmitter.position=this._position}},{key:"update",value:function(t,e){if(this._isExploding&&this._explosionCount++,this._explosionCount>5&&(this._isExploding=!1),this.thrustEmitter.update(t,e),this.leftRotationEmitter.update(t,e),this.rightRotationEmitter.update(t,e),this.explosionEmitter.update(t,e),!this.frozen){this.turningLeft&&this.fuel>0&&this.rotate(t,e,-1),this.turningRight&&this.fuel>0&&this.rotate(t,e,1),this._velocity=this._velocity.add(e.config.gravity.scale(t)),this.thrusting&&this.fuel>0&&(this._velocity=this._velocity.add(this._rotationVector.scale(t*e.config.thrustCoefficient)),this.fuel-=e.config.fuelConsumption*t),this.fuel<0&&(this.fuel=0,e.commands.execute("fuelExpired",e)),this._position=this._position.add(this._velocity.scale(t)),this.positionEmitters();for(var n=0;n<e.terrain.points.length-1;n++)if(w(new k(this._position,4),e.terrain.points[n],e.terrain.points[n+1])){if(this.velocity.sqrMagnitude()<=4&&(this.rotation<5||this.rotation>355))for(var i=0;i<e.safeZones.length;i++)if(e.terrain.points[n]==e.safeZones[i][0]&&e.terrain.points[n+1]==e.safeZones[i][1])return void e.commands.execute("safeLanding",e);e.commands.execute("crashLanding",e),this._isExploding=!0}(this.position.x>110||this.position.x<-10)&&(e.commands.execute("crashLanding",e),this._isExploding=!0)}}},{key:"rotate",value:function(t,e,n){this.fuel-=e.config.fuelConsumption*t*.5,this._rotation+=n*e.config.theta*t,this._rotationVector=this._rotationVector.rotate(n*e.config.theta*t)}},{key:"velocity",get:function(){return this._velocity}},{key:"rotation",get:function(){return(this._rotation%360+360)%360}},{key:"rotationVector",get:function(){return this._rotationVector}},{key:"position",get:function(){return this._position}},{key:"freeze",value:function(){this.frozen=!0,this._velocity=i.ZERO}}]),t}();function z(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return L(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?L(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return a=t.done,t},e:function(t){s=!0,o=t},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function L(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function R(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function j(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function V(t,e,n){return e&&j(t.prototype,e),n&&j(t,n),t}function A(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var D=function(){function t(){R(this,t),A(this,"_wasPressed",!1),A(this,"_lastPressed",Date.now()),A(this,"_onStateChanged",new Set),A(this,"_onKeyUp",new Set),A(this,"_onKeyDown",new Set)}return V(t,[{key:"update",value:function(t,e){if(this._wasPressed!=t){var n;n=t?this._onKeyDown:this._onKeyUp;var i,r=Date.now(),o=z(n);try{for(o.s();!(i=o.n()).done;)(0,i.value)(t,r-this._lastPressed,e)}catch(t){o.e(t)}finally{o.f()}var a,s=z(this._onStateChanged);try{for(s.s();!(a=s.n()).done;)(0,a.value)(t,r-this._lastPressed,e)}catch(t){s.e(t)}finally{s.f()}this._lastPressed=r,this._wasPressed=!this._wasPressed}}},{key:"addUp",value:function(t){this._onKeyUp.add(t)}},{key:"addDown",value:function(t){this._onKeyDown.add(t)}},{key:"addChanged",value:function(t){this._onStateChanged.add(t)}}]),t}(),F=function(){function t(){R(this,t),A(this,"handlers",void 0),A(this,"descriptions",void 0),window.addEventListener("keydown",this.updateDown.bind(this)),window.addEventListener("keyup",this.updateUp.bind(this)),this.handlers=new Map}return V(t,[{key:"registerHandler",value:function(t,e){var n;this.handlers.has(t)?console.warn("Key handler registered twice for keyCode ".concat(t)):(this.handlers.set(t,new D),null===(n=this.descriptions)||void 0===n||n.set(t,e))}},{key:"bindUp",value:function(t,e){this.handlers.get(t).addUp(e)}},{key:"bindDown",value:function(t,e){this.handlers.get(t).addDown(e)}},{key:"bindChanged",value:function(t,e){this.handlers.get(t).addChanged(e)}},{key:"updateDown",value:function(t){console.log(t.key),this.handlers.has(t.key)&&(t.preventDefault(),this.handlers.get(t.key).update(!0,{alt:t.altKey,shift:t.shiftKey,ctrl:t.ctrlKey}))}},{key:"updateUp",value:function(t){this.handlers.has(t.key)&&(t.preventDefault(),this.handlers.get(t.key).update(!1,{alt:t.altKey,shift:t.shiftKey,ctrl:t.ctrlKey}))}},{key:"clear",value:function(){this.handlers=new Map}},{key:"remove",value:function(t){this.handlers.delete(t)}}]),t}();function K(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function U(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function q(t,e,n){return e&&U(t.prototype,e),n&&U(t,n),t}function I(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Z=function(){function t(e,n){K(this,t),I(this,"_name",void 0),I(this,"_action",void 0),this._name=e,this._action=n}return q(t,[{key:"name",get:function(){return this._name}},{key:"invoke",value:function(t){this._action(t)}}]),t}(),X=function(){function t(){K(this,t),I(this,"commands",void 0),this.commands=new Map}return q(t,[{key:"createCommand",value:function(t,e){this.commands.set(t,new Z(t,e))}},{key:"execute",value:function(t,e){this.commands.has(t)?this.commands.get(t).invoke(e):console.warn("Attempting to invoke non-existent command ".concat(t))}}]),t}();function G(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Y=function(){function t(e,n,r,o){var a,s;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),s=void 0,(a="points")in this?Object.defineProperty(this,a,{value:s,enumerable:!0,configurable:!0,writable:!0}):this[a]=s,this.points=[r,o];for(var u=0;u<e;u++)for(var l=this.points.length,h=0;h<l-1;h++){var c=new i((this.points[2*h].x+this.points[2*h+1].x)/2,(this.points[2*h].y+this.points[2*h+1].y)/2);c=c.add(new i(0,_.gaussian(12)*n)),this.points.splice(2*h+1,0,c)}}var e,n;return e=t,(n=[{key:"insertSafeZone",value:function(t,e,n){for(var r=t+n/2,o=r+(e-n/2-r)*Math.random(),a=0,s=this.points[0];s.x<o;)s=this.points[++a];var u=s;a++,s=this.points[a];for(var l=0;s.x<o+n;)l=s.x,this.points.splice(a,1),s=this.points[a];return this.points[a]=new i(l,u.y),[u,this.points[a]]}}])&&G(e.prototype,n),t}();function H(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function N(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var W=function(){function t(e,n){var i=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),N(this,"el",void 0),N(this,"ready",!1),N(this,"continue",!1),N(this,"loop",!1),N(this,"_playing",!1),N(this,"cutoff",0),this.el=new Audio(e),this.el.addEventListener("load",(function(){i.ready=!0})),n&&(this.loop=!0,this.cutoff=n)}var e,n;return e=t,(n=[{key:"play",value:function(){var t=this;this.el.play(),this.continue=!0,this._playing=!0,this.loop?setTimeout((function(){t.continue&&(t.el.currentTime=0,t.playRec())}),1e3*this.cutoff):setTimeout((function(){return t._playing=!1}),1e3*this.el.duration)}},{key:"playRec",value:function(){var t=this;setTimeout((function(){t.continue&&(t.el.currentTime=0,t.playRec())}),1e3*this.cutoff)}},{key:"stop",value:function(){this.el.pause(),this.continue=!1,this._playing=!1,this.el.currentTime=0}},{key:"playing",get:function(){return this._playing}}])&&H(e.prototype,n),t}(),B=document.getElementById("canvas"),$=B.getContext("2d"),J=new F,Q=new X,tt=new i(100,100),et=new s("assets/Lander.png",new i(500,500)),nt=new Y(5,15,new i(0,70),new i(100,70)),it=[];it.push(nt.insertSafeZone(10,40,15)),it.push(nt.insertSafeZone(60,90,15));var rt=Math.min(window.innerWidth,window.innerHeight);B.width=rt,B.height=rt;var ot=new h(rt/tt.x,rt/tt.y);window.addEventListener("resize",(function(){rt=Math.min(window.innerWidth,window.innerHeight),B.width=rt,B.height=rt,ot=new h(rt/tt.x,rt/tt.y),console.log("Resizing to ".concat(rt,"px."))}));var at=new S(new i(tt.x/2,0),et,new i(10,10)),st=new Array,ut=new Array;Q.createCommand("enableThrust",(function(t){t.lander.thrusting=!0,t.lander.fuel>0?t.sounds.mainThruster.play():t.sounds.noFuel.play()})),Q.createCommand("disableThrust",(function(t){t.lander.thrusting=!1,t.sounds.mainThruster.stop(),t.sounds.noFuel.stop()})),Q.createCommand("fuelExpired",(function(t){t.sounds.mainThruster.playing&&(t.sounds.mainThruster.stop(),t.sounds.noFuel.play()),t.sounds.subThruster.playing&&(t.sounds.subThruster.stop(),t.sounds.noFuel.play())})),Q.createCommand("beginTurnLeft",(function(t){t.lander.turningLeft=!0,t.lander.fuel>0?t.sounds.subThruster.play():t.sounds.noFuel.play()})),Q.createCommand("endTurnLeft",(function(t){t.sounds.subThruster.stop(),t.sounds.noFuel.stop(),t.lander.turningLeft=!1})),Q.createCommand("beginTurnRight",(function(t){t.lander.fuel>0?t.sounds.subThruster.play():t.sounds.noFuel.play(),t.lander.turningRight=!0})),Q.createCommand("endTurnRight",(function(t){t.sounds.subThruster.stop(),t.sounds.noFuel.stop(),t.lander.turningRight=!1})),Q.createCommand("safeLanding",(function(t){t.sounds.landing.play(),t.lander.freeze()})),Q.createCommand("crashLanding",(function(t){t.sounds.explosion.play(),t.lander.crashed=!0,t.lander.freeze()})),J.registerHandler(" "),J.registerHandler("q"),J.registerHandler("e"),J.bindDown(" ",(function(){return Q.execute("enableThrust",lt)})),J.bindUp(" ",(function(){return Q.execute("disableThrust",lt)})),J.bindDown("q",(function(){return Q.execute("beginTurnLeft",lt)})),J.bindUp("q",(function(){return Q.execute("endTurnLeft",lt)})),J.bindDown("e",(function(){return Q.execute("beginTurnRight",lt)})),J.bindUp("e",(function(){return Q.execute("endTurnRight",lt)}));var lt={terrain:nt,lander:at,safeZones:it,commands:Q,keys:J,config:{fuelConsumption:20,thrustCoefficient:10,theta:90,gravity:new i(0,1)},sounds:{mainThruster:new W("assets/mainthruster.wav",4),subThruster:new W("assets/subthruster.wav",4),explosion:new W("assets/explosion.wav"),landing:new W("assets/landing.wav"),noFuel:new W("assets/nofuel.wav",1)}};st.push(at),ut.push(at);var ht=0,ct=new i(5,5),ft=new i(5,7.5),dt=new i(5,10);function yt(t){var e=ot.translateValueX(2);t.font="".concat(e,"px Arial");var n=lt.lander.fuel;t.fillStyle=n>0?"#00ff00":"#ffffff";var i=ot.translate(ct);t.fillText("Fuel: ".concat(n.toFixed(2),"L"),i.x,i.y);var r=lt.lander.rotation;t.fillStyle=r<5||r>355?"#00ff00":"#ffffff";var o=ot.translate(ft);t.fillText("Angle: ".concat(r.toFixed(2),"°"),o.x,o.y);var a=lt.lander.velocity.magnitude();t.fillStyle=a<2?"#00ff00":"#ffffff";var s=ot.translate(dt);t.fillText("Velocity: ".concat(a.toFixed(2)," m/s"),s.x,s.y),t.fillStyle="#ffffff"}requestAnimationFrame((function t(e){var n=e-ht;ht=e,function(t,e){for(var n=0;n<ut.length;n++)ut[n].update(t,e)}(n/1e3,lt),function(t){$.clearRect(0,0,rt,rt),function(t,e,n){t.beginPath(),t.lineTo(n.translateValueX(0),n.translateValueY(100)),t.strokeStyle="#ffffff",t.fillStyle="#ffffff";for(var i=1;i<e.points.length;i++){var r=n.translate(e.points[i]);t.lineTo(r.x,r.y)}t.lineTo(n.translateValueX(100),n.translateValueY(100)),t.fill()}($,nt,ot);for(var e=0;e<st.length;e++)st[e].draw($,t,ot);yt($)}(lt),requestAnimationFrame(t)}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9sdW5hcmxhbmRlci8uL3NyYy92ZWN0b3IyLnRzIiwid2VicGFjazovL2x1bmFybGFuZGVyLy4vc3JjL3RleHR1cmUudHMiLCJ3ZWJwYWNrOi8vbHVuYXJsYW5kZXIvLi9zcmMvY29vcmRpbmF0ZS50cyIsIndlYnBhY2s6Ly9sdW5hcmxhbmRlci8uL3NyYy9wYXJ0aWNsZS50cyIsIndlYnBhY2s6Ly9sdW5hcmxhbmRlci8uL3NyYy9jb2xsaXNpb24udHMiLCJ3ZWJwYWNrOi8vbHVuYXJsYW5kZXIvLi9zcmMvcmFuZG9tLnRzIiwid2VicGFjazovL2x1bmFybGFuZGVyLy4vc3JjL2NpcmNsZS50cyIsIndlYnBhY2s6Ly9sdW5hcmxhbmRlci8uL3NyYy9sYW5kZXIudHMiLCJ3ZWJwYWNrOi8vbHVuYXJsYW5kZXIvLi9zcmMva2V5LnRzIiwid2VicGFjazovL2x1bmFybGFuZGVyLy4vc3JjL2NvbW1hbmQudHMiLCJ3ZWJwYWNrOi8vbHVuYXJsYW5kZXIvLi9zcmMvdGVycmFpbi50cyIsIndlYnBhY2s6Ly9sdW5hcmxhbmRlci8uL3NyYy9zb3VuZC50cyIsIndlYnBhY2s6Ly9sdW5hcmxhbmRlci8uL3NyYy9pbmRleC50cyJdLCJuYW1lcyI6WyJWZWN0b3IyIiwieCIsInkiLCJ0aGlzIiwiX3giLCJfeSIsIk1hdGgiLCJyYW5kb20iLCJub3JtYWxpemUiLCJwb3MxIiwicG9zMiIsInNxcnQiLCJwb3ciLCJtYWduaXR1ZGUiLCJzY2FsYXIiLCJvdGhlciIsImRlZ3JlZXMiLCJyYWQiLCJQSSIsImNvcyIsInNpbiIsImRyYXdUZXh0dXJlIiwiY29udGV4dCIsInRleHR1cmUiLCJwb3NpdGlvbiIsInNpemUiLCJyb3RhdGlvbiIsInJlYWR5Iiwic2F2ZSIsInRyYW5zbGF0ZSIsInJvdGF0ZSIsImRyYXdJbWFnZSIsInJlc3RvcmUiLCJUZXh0dXJlIiwiZWwiLCJJbWFnZSIsInNyYyIsImFkZEV2ZW50TGlzdGVuZXIiLCJWaXJ0dWFsQ29vcmRpbmF0ZVN5c3RlbSIsInNjYWxlWCIsInNjYWxlWSIsInYxIiwicCIsIlBhcnRpY2xlQ29udGFpbmVyIiwicGFydGljbGVzIiwiZGVsdGEiLCJzdGF0ZSIsImZpbHRlciIsInVwZGF0ZSIsInJlbWFpbmluZ1RpbWUiLCJwYXJ0aWNsZSIsInB1c2giLCJQYXJ0aWNsZUVtaXR0ZXIiLCJnZW5lcmF0b3IiLCJwcmVkaWNhdGUiLCJyYXRlIiwiY291bnQiLCJfY29udGFpbmVyIiwiX3BhcnRpY2xlR2VuZXJhdG9yIiwiX3ByZWRpY2F0ZSIsIl9jb3VudCIsIl9yYXRlIiwiY29vcmRpbmF0ZXMiLCJmb3JFYWNoIiwiZHJhdyIsIl9lbGFwc2VkIiwiaSIsImFkZCIsIlBhcnRpY2xlRWZmZWN0IiwidmVsb2NpdHkiLCJsaWZldGltZSIsImNlbnRlciIsIl9jZW50ZXIiLCJfdmVsb2NpdHkiLCJfbGlmZXRpbWUiLCJfcm90YXRpb24iLCJfdGV4dHVyZSIsIl9zaXplIiwiX2VsYXBzZWRMaWZldGltZSIsImdsb2JhbEFscGhhIiwiX2RpcmVjdGlvbiIsIl8iLCJzY2FsZSIsImlzQ29sbGlkaW5nIiwiY2lyY2xlIiwicHQxIiwicHQyIiwidjIiLCJiIiwiYyIsImQiLCJyYWRpdXMiLCJpc05hTiIsInUxIiwidTIiLCJyYW5kIiwiQ2lyY2xlIiwiX3JhZGl1cyIsIlRocnVzdEdlbmVyYXRvciIsInJvdGF0aW9uT2Zmc2V0IiwiX3JvdGF0aW9uT2Zmc2V0IiwidGV4IiwidiIsImxhbmRlciIsInJvdGF0aW9uVmVjdG9yIiwiZ2F1c3NpYW4iLCJFeHBsb3Npb25HZW5lcmF0b3IiLCJMYW5kZXIiLCJmcm96ZW4iLCJfcG9zaXRpb24iLCJfcm90YXRpb25WZWN0b3IiLCJ0aHJ1c3RFbWl0dGVyIiwidGhydXN0aW5nIiwiZnVlbCIsImxlZnRSb3RhdGlvbkVtaXR0ZXIiLCJ0dXJuaW5nTGVmdCIsInJpZ2h0Um90YXRpb25FbWl0dGVyIiwidHVybmluZ1JpZ2h0IiwiZXhwbG9zaW9uRW1pdHRlciIsIl9pc0V4cGxvZGluZyIsInBvc2l0aW9uRW1pdHRlcnMiLCJjcmFzaGVkIiwiYmVnaW5QYXRoIiwic3Ryb2tlU3R5bGUiLCJjaXJjbGVwb3MiLCJhcmMiLCJzdHJva2UiLCJhZGpQb3MiLCJhZGpWZWMiLCJsaW5lVG8iLCJzcXJNYWduaXR1ZGUiLCJfZXhwbG9zaW9uQ291bnQiLCJjb25maWciLCJncmF2aXR5IiwidGhydXN0Q29lZmZpY2llbnQiLCJmdWVsQ29uc3VtcHRpb24iLCJjb21tYW5kcyIsImV4ZWN1dGUiLCJ0ZXJyYWluIiwicG9pbnRzIiwibGVuZ3RoIiwiaiIsInNhZmVab25lcyIsImRpcmVjdGlvbiIsInRoZXRhIiwiS2V5SGFuZGxlciIsIkRhdGUiLCJub3ciLCJTZXQiLCJwcmVzc2VkIiwibW9kaWZpZXJzIiwiX3dhc1ByZXNzZWQiLCJzZXQiLCJfb25LZXlEb3duIiwiX29uS2V5VXAiLCJyZXMiLCJfbGFzdFByZXNzZWQiLCJfb25TdGF0ZUNoYW5nZWQiLCJhY3Rpb24iLCJLZXlNYW5hZ2VyIiwid2luZG93IiwidXBkYXRlRG93biIsImJpbmQiLCJ1cGRhdGVVcCIsImhhbmRsZXJzIiwiTWFwIiwia2V5Q29kZSIsImRlc2NyaXB0aW9uIiwiaGFzIiwiY29uc29sZSIsIndhcm4iLCJkZXNjcmlwdGlvbnMiLCJ1cGRhdGVGbiIsImdldCIsImFkZFVwIiwiYWRkRG93biIsImFkZENoYW5nZWQiLCJldmVudCIsImxvZyIsImtleSIsInByZXZlbnREZWZhdWx0IiwiYWx0IiwiYWx0S2V5Iiwic2hpZnQiLCJzaGlmdEtleSIsImN0cmwiLCJjdHJsS2V5Iiwia2V5Y29kZSIsIkNvbW1hbmQiLCJuYW1lIiwiX25hbWUiLCJfYWN0aW9uIiwiQ29tbWFuZFNlcnZpY2UiLCJpbnZva2UiLCJUZXJyYWluIiwiaXRlcmF0aW9ucyIsInJvdWdobmVzcyIsInAxIiwicDIiLCJzYXZlZExlbmd0aCIsIm1pZCIsInNwbGljZSIsIm1pblgiLCJtYXhYIiwid2lkdGgiLCJ0YXJnZXRYTWluIiwib2Zmc2V0IiwicG9pbnQiLCJzYXZlZCIsIlNvdW5kRWZmZWN0Iiwic291cmNlIiwiY3V0b2ZmIiwiQXVkaW8iLCJsb29wIiwicGxheSIsIl9wbGF5aW5nIiwic2V0VGltZW91dCIsImN1cnJlbnRUaW1lIiwicGxheVJlYyIsImR1cmF0aW9uIiwicGF1c2UiLCJjYW52YXMiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiZ2V0Q29udGV4dCIsImtleXMiLCJ3b3JsZFNpemUiLCJsYW5kZXJUZXh0dXJlIiwiaW5zZXJ0U2FmZVpvbmUiLCJtYXhDb29yZCIsIm1pbiIsImlubmVyV2lkdGgiLCJpbm5lckhlaWdodCIsImhlaWdodCIsInZjcyIsImRyYXdhYmxlcyIsIkFycmF5IiwidGlja2luZyIsImNyZWF0ZUNvbW1hbmQiLCJnbG9iYWxTdGF0ZSIsInNvdW5kcyIsIm1haW5UaHJ1c3RlciIsIm5vRnVlbCIsInN0b3AiLCJwbGF5aW5nIiwic3ViVGhydXN0ZXIiLCJsYW5kaW5nIiwiZnJlZXplIiwiZXhwbG9zaW9uIiwicmVnaXN0ZXJIYW5kbGVyIiwiYmluZERvd24iLCJiaW5kVXAiLCJsYXN0VGltZSIsImZ1ZWxQb3NpdGlvbiIsImFuZ2xlUG9zaXRpb24iLCJ2ZWxvY2l0eVBvc2l0aW9uIiwiZHJhd1RleHQiLCJmb250U2l6ZSIsInRyYW5zbGF0ZVZhbHVlWCIsImZvbnQiLCJmaWxsU3R5bGUiLCJhZGp1c3RlZEZ1ZWxQb3NpdGlvbiIsImZpbGxUZXh0IiwidG9GaXhlZCIsImFuZ2xlIiwiYWRqdXN0ZWRBbmdsZVBvc2l0aW9uIiwibWFnbiIsImFkanVzdGVkVmVsb2NpdHlQb3NpdGlvbiIsInJlcXVlc3RBbmltYXRpb25GcmFtZSIsImNsZWFyUmVjdCIsImN0eCIsInRyYW5zbGF0ZVZhbHVlWSIsInB0IiwiZmlsbCIsImRyYXdUZXJyYWluIl0sIm1hcHBpbmdzIjoiaVRBQU8sSUFBTUEsRUFBYixXQVVFLFdBQVlDLEVBQVdDLEksNEZBQVcscUJBUGIsR0FPYSxZQU5iLEdBT25CQyxLQUFLQyxHQUFLSCxFQUNWRSxLQUFLRSxHQUFLSCxF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dCBjbGFzcyBWZWN0b3IyIHtcbiAgc3RhdGljIFpFUk86IFZlY3RvcjIgPSBuZXcgVmVjdG9yMigwLCAwKTtcblxuICBwcml2YXRlIF94OiBudW1iZXIgPSAwO1xuICBwcml2YXRlIF95OiBudW1iZXIgPSAwO1xuXG4gIHN0YXRpYyByYW5kb20oKTogVmVjdG9yMiB7XG4gICAgcmV0dXJuIG5ldyBWZWN0b3IyKE1hdGgucmFuZG9tKCksIE1hdGgucmFuZG9tKCkpLm5vcm1hbGl6ZSgpO1xuICB9XG5cbiAgY29uc3RydWN0b3IoeDogbnVtYmVyLCB5OiBudW1iZXIpIHtcbiAgICB0aGlzLl94ID0geDtcbiAgICB0aGlzLl95ID0geTtcbiAgfVxuXG4gIHB1YmxpYyBzdGF0aWMgZGlzdGFuY2UocG9zMTogVmVjdG9yMiwgcG9zMjogVmVjdG9yMikge1xuICAgIHJldHVybiBNYXRoLnNxcnQoXG4gICAgICBNYXRoLnBvdyhwb3MxLnggLSBwb3MyLngsIDIpICsgTWF0aC5wb3cocG9zMS55IC0gcG9zMi55LCAyKVxuICAgICk7XG4gIH1cblxuICBnZXQgeCgpOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLl94O1xuICB9XG5cbiAgZ2V0IHkoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5feTtcbiAgfVxuXG4gIHNxck1hZ25pdHVkZSgpOiBudW1iZXIge1xuICAgIHJldHVybiBNYXRoLnBvdyh0aGlzLngsIDIpICsgTWF0aC5wb3codGhpcy55LCAyKTtcbiAgfVxuXG4gIG1hZ25pdHVkZSgpOiBudW1iZXIge1xuICAgIHJldHVybiBNYXRoLnNxcnQoTWF0aC5wb3codGhpcy54LCAyKSArIE1hdGgucG93KHRoaXMueSwgMikpO1xuICB9XG5cbiAgbm9ybWFsaXplKCk6IFZlY3RvcjIge1xuICAgIGNvbnN0IG1hZ25pdHVkZSA9IHRoaXMubWFnbml0dWRlKCk7XG4gICAgcmV0dXJuIG5ldyBWZWN0b3IyKHRoaXMueCAvIG1hZ25pdHVkZSwgdGhpcy55IC8gbWFnbml0dWRlKTtcbiAgfVxuXG4gIHNjYWxlKHNjYWxhcjogbnVtYmVyKTogVmVjdG9yMiB7XG4gICAgcmV0dXJuIG5ldyBWZWN0b3IyKHRoaXMueCAqIHNjYWxhciwgdGhpcy55ICogc2NhbGFyKTtcbiAgfVxuXG4gIGFkZChvdGhlcjogVmVjdG9yMik6IFZlY3RvcjIge1xuICAgIHJldHVybiBuZXcgVmVjdG9yMih0aGlzLnggKyBvdGhlci54LCB0aGlzLnkgKyBvdGhlci55KTtcbiAgfVxuXG4gIHJvdGF0ZShkZWdyZWVzOiBudW1iZXIpOiBWZWN0b3IyIHtcbiAgICBjb25zdCByYWQgPSAoZGVncmVlcyAqIE1hdGguUEkpIC8gMTgwO1xuICAgIGxldCB2YWwgPSBuZXcgVmVjdG9yMihcbiAgICAgIHRoaXMueCAqIE1hdGguY29zKHJhZCkgLSBNYXRoLnNpbihyYWQpICogdGhpcy55LFxuICAgICAgdGhpcy54ICogTWF0aC5zaW4ocmFkKSArIHRoaXMueSAqIE1hdGguY29zKHJhZClcbiAgICApO1xuICAgIHJldHVybiB2YWw7XG4gIH1cblxuICB0b1N0cmluZygpOiBzdHJpbmcge1xuICAgIHJldHVybiBgVmVjdG9yMih4OiAke3RoaXMueH0sIHk6ICR7dGhpcy55fSlgO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IFZlY3RvcjI7XG4iLCJpbXBvcnQgVmVjdG9yMiBmcm9tIFwiLi92ZWN0b3IyXCI7XG5cbmV4cG9ydCBmdW5jdGlvbiBkcmF3VGV4dHVyZShcbiAgY29udGV4dDogQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJELFxuICB0ZXh0dXJlOiBUZXh0dXJlLFxuICBwb3NpdGlvbjogVmVjdG9yMixcbiAgc2l6ZTogVmVjdG9yMixcbiAgcm90YXRpb246IG51bWJlciA9IDBcbikge1xuICBpZiAoIXRleHR1cmUucmVhZHkpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgY29udGV4dC5zYXZlKCk7XG4gIGNvbnRleHQudHJhbnNsYXRlKHBvc2l0aW9uLngsIHBvc2l0aW9uLnkpO1xuICBjb250ZXh0LnJvdGF0ZSgocm90YXRpb24gKiBNYXRoLlBJKSAvIDE4MCk7XG4gIGNvbnRleHQudHJhbnNsYXRlKC1wb3NpdGlvbi54LCAtcG9zaXRpb24ueSk7XG4gIGNvbnRleHQuZHJhd0ltYWdlKFxuICAgIHRleHR1cmUudGV4dHVyZSxcbiAgICBwb3NpdGlvbi54IC0gc2l6ZS54IC8gMixcbiAgICBwb3NpdGlvbi55IC0gc2l6ZS55IC8gMixcbiAgICBzaXplLngsXG4gICAgc2l6ZS55XG4gICk7XG4gIGNvbnRleHQucmVzdG9yZSgpO1xufVxuXG5leHBvcnQgY2xhc3MgVGV4dHVyZSB7XG4gIHNpemU6IFZlY3RvcjI7XG4gIGVsOiBIVE1MSW1hZ2VFbGVtZW50O1xuICByZWFkeTogYm9vbGVhbiA9IGZhbHNlO1xuICBjb25zdHJ1Y3Rvcih0ZXh0dXJlOiBzdHJpbmcsIHNpemU6IFZlY3RvcjIpIHtcbiAgICB0aGlzLmVsID0gbmV3IEltYWdlKCk7XG4gICAgdGhpcy5lbC5zcmMgPSB0ZXh0dXJlO1xuICAgIHRoaXMuZWwuYWRkRXZlbnRMaXN0ZW5lcihcImxvYWRcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5yZWFkeSA9IHRydWU7XG4gICAgfSk7XG4gIH1cblxuICBnZXQgdGV4dHVyZSgpOiBDYW52YXNJbWFnZVNvdXJjZSB7XG4gICAgcmV0dXJuIHRoaXMuZWw7XG4gIH1cbn1cbmBgO1xuIiwiaW1wb3J0IFZlY3RvcjIgZnJvbSBcIi4vdmVjdG9yMlwiO1xuXG5leHBvcnQgY2xhc3MgVmlydHVhbENvb3JkaW5hdGVTeXN0ZW0ge1xuICBwcml2YXRlIHNjYWxlWDogbnVtYmVyO1xuICBwcml2YXRlIHNjYWxlWTogbnVtYmVyO1xuXG4gIGNvbnN0cnVjdG9yKHNjYWxlWDogbnVtYmVyLCBzY2FsZVk6IG51bWJlcikge1xuICAgIHRoaXMuc2NhbGVYID0gc2NhbGVYO1xuICAgIHRoaXMuc2NhbGVZID0gc2NhbGVZO1xuICB9XG5cbiAgdHJhbnNsYXRlKHYxOiBWZWN0b3IyKTogVmVjdG9yMiB7XG4gICAgcmV0dXJuIG5ldyBWZWN0b3IyKHYxLnggKiB0aGlzLnNjYWxlWCwgdjEueSAqIHRoaXMuc2NhbGVZKTtcbiAgfVxuXG4gIHRyYW5zbGF0ZVZhbHVlWChwOiBudW1iZXIpOiBudW1iZXIge1xuICAgIHJldHVybiBwICogdGhpcy5zY2FsZVg7XG4gIH1cblxuICB0cmFuc2xhdGVWYWx1ZVkocDogbnVtYmVyKTogbnVtYmVyIHtcbiAgICByZXR1cm4gcCAqIHRoaXMuc2NhbGVZO1xuICB9XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ29vcmRpbmF0ZVRyYW5zbGF0YWJsZSB7XG4gIHRyYW5zbGF0ZSh2MTogVmVjdG9yMik6IFZlY3RvcjI7XG4gIHRyYW5zbGF0ZVZhbHVlWChwOiBudW1iZXIpOiBudW1iZXI7XG4gIHRyYW5zbGF0ZVZhbHVlWShwOiBudW1iZXIpOiBudW1iZXI7XG59XG4iLCJpbXBvcnQgVGlja2luZyBmcm9tIFwiLi90aWNraW5nXCI7XG5pbXBvcnQgVmVjdG9yMiBmcm9tIFwiLi92ZWN0b3IyXCI7XG5pbXBvcnQgRHJhd2FibGUgZnJvbSBcIi4vZHJhd2FibGVcIjtcbmltcG9ydCB7IFByZWRpY2F0ZSB9IGZyb20gXCIuL2Z1bmN0aW9uYWxcIjtcbmltcG9ydCB7IGRyYXdUZXh0dXJlLCBUZXh0dXJlIH0gZnJvbSBcIi4vdGV4dHVyZVwiO1xuaW1wb3J0IHsgQ29vcmRpbmF0ZVRyYW5zbGF0YWJsZSB9IGZyb20gXCIuL2Nvb3JkaW5hdGVcIjtcblxuZXhwb3J0IGNsYXNzIFBhcnRpY2xlQ29udGFpbmVyPFQ+IGltcGxlbWVudHMgVGlja2luZzxUPiB7XG4gIHBhcnRpY2xlczogQXJyYXk8UGFydGljbGVFZmZlY3Q8VD4+O1xuICB1cGRhdGUoZGVsdGE6IG51bWJlciwgc3RhdGU6IFQpIHtcbiAgICAvLyBUT0RPOiBDaGVjayBvbiB0aGUgZWZmaWNpZW5jeSBvZiB0aGlzLlxuICAgIHRoaXMucGFydGljbGVzID0gdGhpcy5wYXJ0aWNsZXMuZmlsdGVyKChwKSA9PiB7XG4gICAgICBwLnVwZGF0ZShkZWx0YSwgc3RhdGUpO1xuICAgICAgcmV0dXJuIHAucmVtYWluaW5nVGltZSA+IDA7XG4gICAgfSk7XG4gIH1cbiAgYWRkKHBhcnRpY2xlOiBQYXJ0aWNsZUVmZmVjdDxUPikge1xuICAgIHRoaXMucGFydGljbGVzLnB1c2gocGFydGljbGUpO1xuICB9XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5wYXJ0aWNsZXMgPSBbXTtcbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgUGFydGljbGVFbWl0dGVyPFQ+IGltcGxlbWVudHMgVGlja2luZzxUPiwgRHJhd2FibGU8VD4ge1xuICBwb3NpdGlvbjogVmVjdG9yMjtcbiAgcHJpdmF0ZSBfcmF0ZTogbnVtYmVyID0gMC4xO1xuICBwcml2YXRlIF9lbGFwc2VkOiBudW1iZXIgPSAwO1xuICBwcml2YXRlIF9jb3VudDogbnVtYmVyID0gMTA7XG4gIHByaXZhdGUgX2NvbnRhaW5lcjogUGFydGljbGVDb250YWluZXI8VD47XG4gIHByaXZhdGUgX3BhcnRpY2xlR2VuZXJhdG9yOiBQYXJ0aWNsZUdlbmVyYXRvcjxUPjtcbiAgcHJpdmF0ZSBfcHJlZGljYXRlOiBQcmVkaWNhdGU8VD47XG5cbiAgY29uc3RydWN0b3IoXG4gICAgZ2VuZXJhdG9yOiBQYXJ0aWNsZUdlbmVyYXRvcjxUPixcbiAgICBwcmVkaWNhdGU6IFByZWRpY2F0ZTxUPixcbiAgICByYXRlOiBudW1iZXIgPSAwLjEsXG4gICAgY291bnQ6IG51bWJlciA9IDEwXG4gICkge1xuICAgIHRoaXMuX2NvbnRhaW5lciA9IG5ldyBQYXJ0aWNsZUNvbnRhaW5lcjxUPigpO1xuICAgIHRoaXMuX3BhcnRpY2xlR2VuZXJhdG9yID0gZ2VuZXJhdG9yO1xuICAgIHRoaXMuX3ByZWRpY2F0ZSA9IHByZWRpY2F0ZTtcbiAgICB0aGlzLl9jb3VudCA9IGNvdW50O1xuICAgIHRoaXMuX3JhdGUgPSByYXRlO1xuICB9XG4gIGRyYXcoXG4gICAgY29udGV4dDogQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJELFxuICAgIHN0YXRlOiBULFxuICAgIGNvb3JkaW5hdGVzPzogQ29vcmRpbmF0ZVRyYW5zbGF0YWJsZVxuICApOiB2b2lkIHtcbiAgICB0aGlzLl9jb250YWluZXIucGFydGljbGVzLmZvckVhY2goKHApID0+IHtcbiAgICAgIHAuZHJhdyhjb250ZXh0LCBzdGF0ZSwgY29vcmRpbmF0ZXMpO1xuICAgIH0pO1xuICB9XG5cbiAgdXBkYXRlKGRlbHRhOiBudW1iZXIsIHN0YXRlOiBUKSB7XG4gICAgaWYgKHRoaXMuX3ByZWRpY2F0ZShzdGF0ZSkpIHtcbiAgICAgIHRoaXMuX2VsYXBzZWQgKz0gZGVsdGE7XG4gICAgICBpZiAodGhpcy5fZWxhcHNlZCA+IHRoaXMuX3JhdGUpIHtcbiAgICAgICAgdGhpcy5fZWxhcHNlZCAtPSB0aGlzLl9yYXRlO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuX2NvdW50OyBpKyspIHtcbiAgICAgICAgICB0aGlzLl9jb250YWluZXIuYWRkKFxuICAgICAgICAgICAgbmV3IFBhcnRpY2xlRWZmZWN0PFQ+KFxuICAgICAgICAgICAgICB0aGlzLnBvc2l0aW9uLFxuICAgICAgICAgICAgICB0aGlzLl9wYXJ0aWNsZUdlbmVyYXRvci52ZWxvY2l0eShzdGF0ZSksXG4gICAgICAgICAgICAgIHRoaXMuX3BhcnRpY2xlR2VuZXJhdG9yLmxpZmV0aW1lKHN0YXRlKSxcbiAgICAgICAgICAgICAgdGhpcy5fcGFydGljbGVHZW5lcmF0b3Iucm90YXRpb24oc3RhdGUpLFxuICAgICAgICAgICAgICB0aGlzLl9wYXJ0aWNsZUdlbmVyYXRvci50ZXh0dXJlKHN0YXRlKSxcbiAgICAgICAgICAgICAgdGhpcy5fcGFydGljbGVHZW5lcmF0b3Iuc2l6ZShzdGF0ZSlcbiAgICAgICAgICAgIClcbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHRoaXMuX2NvbnRhaW5lci51cGRhdGUoZGVsdGEsIHN0YXRlKTtcbiAgfVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIFBhcnRpY2xlR2VuZXJhdG9yPFQ+IHtcbiAgdGV4dHVyZShzdGF0ZTogVCk6IFRleHR1cmU7XG4gIHNpemUoc3RhdGU6IFQpOiBWZWN0b3IyO1xuICB2ZWxvY2l0eShzdGF0ZTogVCk6IFZlY3RvcjI7XG4gIGxpZmV0aW1lKHN0YXRlOiBUKTogbnVtYmVyO1xuICByb3RhdGlvbihzdGF0ZTogVCk6IG51bWJlcjtcbn1cblxuZXhwb3J0IGNsYXNzIFBhcnRpY2xlRWZmZWN0PFQ+IGltcGxlbWVudHMgRHJhd2FibGU8VD4sIFRpY2tpbmc8VD4ge1xuICBwcml2YXRlIF9jZW50ZXI6IFZlY3RvcjI7XG4gIHByaXZhdGUgX2RpcmVjdGlvbjogVmVjdG9yMjtcbiAgcHJpdmF0ZSBfdmVsb2NpdHk6IFZlY3RvcjI7XG4gIHByaXZhdGUgX2xpZmV0aW1lOiBudW1iZXI7XG4gIHByaXZhdGUgX3JvdGF0aW9uOiBudW1iZXI7XG4gIHByaXZhdGUgX2VsYXBzZWRMaWZldGltZTogbnVtYmVyO1xuICBwcml2YXRlIF90ZXh0dXJlOiBUZXh0dXJlO1xuICBwcml2YXRlIF9zaXplOiBWZWN0b3IyO1xuICBjb25zdHJ1Y3RvcihcbiAgICBjZW50ZXI6IFZlY3RvcjIsXG4gICAgdmVsb2NpdHk6IFZlY3RvcjIsXG4gICAgbGlmZXRpbWU6IG51bWJlcixcbiAgICByb3RhdGlvbjogbnVtYmVyLFxuICAgIHRleHR1cmU6IFRleHR1cmUsXG4gICAgc2l6ZTogVmVjdG9yMlxuICApIHtcbiAgICB0aGlzLl9jZW50ZXIgPSBjZW50ZXI7XG4gICAgdGhpcy5fdmVsb2NpdHkgPSB2ZWxvY2l0eTtcbiAgICB0aGlzLl9saWZldGltZSA9IGxpZmV0aW1lO1xuICAgIHRoaXMuX3JvdGF0aW9uID0gcm90YXRpb247XG4gICAgdGhpcy5fdGV4dHVyZSA9IHRleHR1cmU7XG4gICAgdGhpcy5fc2l6ZSA9IHNpemU7XG4gICAgdGhpcy5fZWxhcHNlZExpZmV0aW1lID0gMDtcbiAgfVxuXG4gIGRyYXcoXG4gICAgY29udGV4dDogQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJELFxuICAgIHN0YXRlOiBULFxuICAgIGNvb3JkaW5hdGVzOiBDb29yZGluYXRlVHJhbnNsYXRhYmxlXG4gICkge1xuICAgIGNvbnRleHQuZ2xvYmFsQWxwaGEgPSAxIC0gdGhpcy5fZWxhcHNlZExpZmV0aW1lIC8gdGhpcy5fbGlmZXRpbWU7XG4gICAgZHJhd1RleHR1cmUoXG4gICAgICBjb250ZXh0LFxuICAgICAgdGhpcy5fdGV4dHVyZSxcbiAgICAgIGNvb3JkaW5hdGVzLnRyYW5zbGF0ZSh0aGlzLl9jZW50ZXIpLFxuICAgICAgY29vcmRpbmF0ZXMudHJhbnNsYXRlKHRoaXMuX3NpemUpLFxuICAgICAgdGhpcy5fcm90YXRpb25cbiAgICApO1xuICAgIGNvbnRleHQuZ2xvYmFsQWxwaGEgPSAxO1xuICB9XG5cbiAgcHVibGljIGdldCB2ZWxvY2l0eSgpOiBWZWN0b3IyIHtcbiAgICByZXR1cm4gdGhpcy5fdmVsb2NpdHk7XG4gIH1cblxuICBwdWJsaWMgZ2V0IGRpcmVjdGlvbigpOiBWZWN0b3IyIHtcbiAgICByZXR1cm4gdGhpcy5fZGlyZWN0aW9uO1xuICB9XG5cbiAgcHVibGljIGdldCBjZW50ZXIoKTogVmVjdG9yMiB7XG4gICAgcmV0dXJuIHRoaXMuX2NlbnRlcjtcbiAgfVxuXG4gIHB1YmxpYyBnZXQgcmVtYWluaW5nVGltZSgpOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLl9saWZldGltZSAtIHRoaXMuX2VsYXBzZWRMaWZldGltZTtcbiAgfVxuXG4gIHB1YmxpYyB1cGRhdGUoZGVsdGE6IG51bWJlciwgXzogVCkge1xuICAgIHRoaXMuX2VsYXBzZWRMaWZldGltZSArPSBkZWx0YTtcbiAgICB0aGlzLl9jZW50ZXIgPSB0aGlzLl9jZW50ZXIuYWRkKHRoaXMuX3ZlbG9jaXR5LnNjYWxlKGRlbHRhKSk7XG4gIH1cbn1cbiIsImltcG9ydCBWZWN0b3IyIGZyb20gXCIuL3ZlY3RvcjJcIjtcbmltcG9ydCBDaXJjbGUgZnJvbSBcIi4vY2lyY2xlXCI7XG5cbi8qKlxuICogTGluZS1DaXJjbGUgSW50ZXJzZWN0aW9uXG4gKiBAc291cmNlIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzM3MjI0OTEyL2NpcmNsZS1saW5lLXNlZ21lbnQtY29sbGlzaW9uXG4gKlxuICogQHBhcmFtIGNpcmNsZSBUaGUgY2lyY2xlIHRvIHRlc3QgZm9yIGludGVyc2VjdGlvbi5cbiAqIEBwYXJhbSBwdDEgVGhlIGZpcnN0IHBvaW50IG9mIHRoZSBsaW5lLlxuICogQHBhcmFtIHB0MiBUaGUgc2Vjb25kIHBvaW50IG9mIHRoZSBsaW5lLlxuICovXG5leHBvcnQgZnVuY3Rpb24gaXNDb2xsaWRpbmcoXG4gIGNpcmNsZTogQ2lyY2xlLFxuICBwdDE6IFZlY3RvcjIsXG4gIHB0MjogVmVjdG9yMlxuKTogYm9vbGVhbiB7XG4gIGxldCB2MSA9IG5ldyBWZWN0b3IyKHB0Mi54IC0gcHQxLngsIHB0Mi55IC0gcHQxLnkpO1xuICBsZXQgdjIgPSBuZXcgVmVjdG9yMihwdDEueCAtIGNpcmNsZS5jZW50ZXIueCwgcHQxLnkgLSBjaXJjbGUuY2VudGVyLnkpO1xuICBsZXQgYiA9IC0yICogKHYxLnggKiB2Mi54ICsgdjEueSAqIHYyLnkpO1xuICBsZXQgYyA9IDIgKiAodjEueCAqIHYxLnggKyB2MS55ICogdjEueSk7XG4gIGxldCBkID0gTWF0aC5zcXJ0KFxuICAgIGIgKiBiIC0gMiAqIGMgKiAodjIueCAqIHYyLnggKyB2Mi55ICogdjIueSAtIGNpcmNsZS5yYWRpdXMgKiBjaXJjbGUucmFkaXVzKVxuICApO1xuICBpZiAoaXNOYU4oZCkpIHtcbiAgICAvLyBubyBpbnRlcmNlcHRcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgLy8gVGhlc2UgcmVwcmVzZW50IHRoZSB1bml0IGRpc3RhbmNlIG9mIHBvaW50IG9uZSBhbmQgdHdvIG9uIHRoZSBsaW5lXG4gIGxldCB1MSA9IChiIC0gZCkgLyBjO1xuICBsZXQgdTIgPSAoYiArIGQpIC8gYztcbiAgaWYgKHUxIDw9IDEgJiYgdTEgPj0gMCkge1xuICAgIC8vIElmIHBvaW50IG9uIHRoZSBsaW5lIHNlZ21lbnRcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuICBpZiAodTIgPD0gMSAmJiB1MiA+PSAwKSB7XG4gICAgLy8gSWYgcG9pbnQgb24gdGhlIGxpbmUgc2VnbWVudFxuICAgIHJldHVybiB0cnVlO1xuICB9XG4gIHJldHVybiBmYWxzZTtcbn1cbiIsImNsYXNzIFJhbmRvbSB7XG4gIGdhdXNzaWFuKGNvdW50OiBudW1iZXIgPSA2KSB7XG4gICAgbGV0IHJhbmQgPSAwO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb3VudDsgaSsrKSB7XG4gICAgICByYW5kICs9IE1hdGgucmFuZG9tKCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHJhbmQgLyBjb3VudDtcbiAgfVxufVxuXG5leHBvcnQgY29uc3QgcmFuZG9tID0gbmV3IFJhbmRvbSgpO1xuIiwiaW1wb3J0IFZlY3RvcjIgZnJvbSBcIi4vdmVjdG9yMlwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDaXJjbGUge1xuICBwcml2YXRlIF9jZW50ZXI6IFZlY3RvcjI7XG4gIHByaXZhdGUgX3JhZGl1czogbnVtYmVyO1xuXG4gIGNvbnN0cnVjdG9yKGNlbnRlcjogVmVjdG9yMiwgcmFkaXVzOiBudW1iZXIpIHtcbiAgICB0aGlzLl9jZW50ZXIgPSBjZW50ZXI7XG4gICAgdGhpcy5fcmFkaXVzID0gcmFkaXVzO1xuICB9XG5cbiAgcHVibGljIGdldCBjZW50ZXIoKTogVmVjdG9yMiB7XG4gICAgcmV0dXJuIHRoaXMuX2NlbnRlcjtcbiAgfVxuXG4gIHB1YmxpYyBnZXQgcmFkaXVzKCk6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMuX3JhZGl1cztcbiAgfVxufVxuIiwiaW1wb3J0IFZlY3RvcjIgZnJvbSBcIi4vdmVjdG9yMlwiO1xuaW1wb3J0IERyYXdhYmxlIGZyb20gXCIuL2RyYXdhYmxlXCI7XG5pbXBvcnQgVGlja2luZyBmcm9tIFwiLi90aWNraW5nXCI7XG5pbXBvcnQgeyBDb29yZGluYXRlVHJhbnNsYXRhYmxlIH0gZnJvbSBcIi4vY29vcmRpbmF0ZVwiO1xuaW1wb3J0IHsgZHJhd1RleHR1cmUsIFRleHR1cmUgfSBmcm9tIFwiLi90ZXh0dXJlXCI7XG5pbXBvcnQgeyBHbG9iYWxTdGF0ZSB9IGZyb20gXCIuL3N0YXRlXCI7XG5pbXBvcnQgeyBQYXJ0aWNsZUVtaXR0ZXIsIFBhcnRpY2xlR2VuZXJhdG9yIH0gZnJvbSBcIi4vcGFydGljbGVcIjtcbmltcG9ydCB7IGlzQ29sbGlkaW5nIH0gZnJvbSBcIi4vY29sbGlzaW9uXCI7XG5pbXBvcnQgeyByYW5kb20gfSBmcm9tIFwiLi9yYW5kb21cIjtcbmltcG9ydCBDaXJjbGUgZnJvbSBcIi4vY2lyY2xlXCI7XG5cbmNsYXNzIFRocnVzdEdlbmVyYXRvciBpbXBsZW1lbnRzIFBhcnRpY2xlR2VuZXJhdG9yPEdsb2JhbFN0YXRlPiB7XG4gIHByaXZhdGUgX3JvdGF0aW9uT2Zmc2V0OiBudW1iZXI7XG5cbiAgY29uc3RydWN0b3Iocm90YXRpb25PZmZzZXQ6IG51bWJlciA9IDApIHtcbiAgICB0aGlzLl9yb3RhdGlvbk9mZnNldCA9IHJvdGF0aW9uT2Zmc2V0O1xuICB9XG5cbiAgcHJpdmF0ZSB0ZXg6IFRleHR1cmUgPSBuZXcgVGV4dHVyZShcImFzc2V0cy9TbW9rZS5wbmdcIiwgbmV3IFZlY3RvcjIoMzIsIDMyKSk7XG4gIHByaXZhdGUgX3NpemU6IFZlY3RvcjIgPSBuZXcgVmVjdG9yMigwLjc1LCAwLjc1KTtcbiAgdGV4dHVyZShfOiBHbG9iYWxTdGF0ZSk6IFRleHR1cmUge1xuICAgIHJldHVybiB0aGlzLnRleDtcbiAgfVxuICBzaXplKHN0YXRlOiBHbG9iYWxTdGF0ZSk6IFZlY3RvcjIge1xuICAgIHJldHVybiB0aGlzLl9zaXplO1xuICB9XG4gIHZlbG9jaXR5KHN0YXRlOiBHbG9iYWxTdGF0ZSk6IFZlY3RvcjIge1xuICAgIGxldCB2ID0gc3RhdGUubGFuZGVyLnJvdGF0aW9uVmVjdG9yO1xuICAgIGxldCByb3RhdGlvbiA9IHJhbmRvbS5nYXVzc2lhbigxMikgKiAxMDAgLSA1MDtcbiAgICB2ID0gdi5yb3RhdGUocm90YXRpb24gKyB0aGlzLl9yb3RhdGlvbk9mZnNldCk7XG4gICAgdiA9IHYuc2NhbGUoLTUgKiByYW5kb20uZ2F1c3NpYW4oMTIpKTtcbiAgICByZXR1cm4gdjtcbiAgfVxuICBsaWZldGltZShzdGF0ZTogR2xvYmFsU3RhdGUpOiBudW1iZXIge1xuICAgIHJldHVybiA1ICsgcmFuZG9tLmdhdXNzaWFuKDEyKTtcbiAgfVxuICByb3RhdGlvbihzdGF0ZTogR2xvYmFsU3RhdGUpOiBudW1iZXIge1xuICAgIHJldHVybiAwO1xuICB9XG59XG5jbGFzcyBFeHBsb3Npb25HZW5lcmF0b3IgaW1wbGVtZW50cyBQYXJ0aWNsZUdlbmVyYXRvcjxHbG9iYWxTdGF0ZT4ge1xuICBwcml2YXRlIF9yb3RhdGlvbk9mZnNldDogbnVtYmVyO1xuXG4gIGNvbnN0cnVjdG9yKHJvdGF0aW9uT2Zmc2V0OiBudW1iZXIgPSAwKSB7XG4gICAgdGhpcy5fcm90YXRpb25PZmZzZXQgPSByb3RhdGlvbk9mZnNldDtcbiAgfVxuXG4gIHByaXZhdGUgdGV4OiBUZXh0dXJlID0gbmV3IFRleHR1cmUoXCJhc3NldHMvRmlyZS5wbmdcIiwgbmV3IFZlY3RvcjIoMzIsIDMyKSk7XG4gIHByaXZhdGUgX3NpemU6IFZlY3RvcjIgPSBuZXcgVmVjdG9yMigxLCAxKTtcbiAgdGV4dHVyZShfOiBHbG9iYWxTdGF0ZSk6IFRleHR1cmUge1xuICAgIHJldHVybiB0aGlzLnRleDtcbiAgfVxuICBzaXplKHN0YXRlOiBHbG9iYWxTdGF0ZSk6IFZlY3RvcjIge1xuICAgIHJldHVybiB0aGlzLl9zaXplO1xuICB9XG4gIHZlbG9jaXR5KHN0YXRlOiBHbG9iYWxTdGF0ZSk6IFZlY3RvcjIge1xuICAgIGxldCB2ID0gc3RhdGUubGFuZGVyLnJvdGF0aW9uVmVjdG9yO1xuICAgIGxldCByb3RhdGlvbiA9IE1hdGgucmFuZG9tKCkgKiAzNjA7XG4gICAgdiA9IHYucm90YXRlKHJvdGF0aW9uKTtcbiAgICB2ID0gdi5zY2FsZSgtMjAgKiByYW5kb20uZ2F1c3NpYW4oMTIpKTtcbiAgICByZXR1cm4gdjtcbiAgfVxuICBsaWZldGltZShzdGF0ZTogR2xvYmFsU3RhdGUpOiBudW1iZXIge1xuICAgIHJldHVybiA1ICsgcmFuZG9tLmdhdXNzaWFuKDEyKTtcbiAgfVxuICByb3RhdGlvbihzdGF0ZTogR2xvYmFsU3RhdGUpOiBudW1iZXIge1xuICAgIHJldHVybiAwO1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBMYW5kZXIgaW1wbGVtZW50cyBEcmF3YWJsZTxHbG9iYWxTdGF0ZT4sIFRpY2tpbmc8R2xvYmFsU3RhdGU+IHtcbiAgcHJpdmF0ZSBzaXplOiBWZWN0b3IyO1xuICBwcml2YXRlIHRleHR1cmU6IFRleHR1cmU7XG4gIHByaXZhdGUgZnJvemVuOiBib29sZWFuO1xuICBwcml2YXRlIHRocnVzdEVtaXR0ZXI6IFBhcnRpY2xlRW1pdHRlcjxHbG9iYWxTdGF0ZT47XG4gIHByaXZhdGUgbGVmdFJvdGF0aW9uRW1pdHRlcjogUGFydGljbGVFbWl0dGVyPEdsb2JhbFN0YXRlPjtcbiAgcHJpdmF0ZSByaWdodFJvdGF0aW9uRW1pdHRlcjogUGFydGljbGVFbWl0dGVyPEdsb2JhbFN0YXRlPjtcbiAgcHJpdmF0ZSBleHBsb3Npb25FbWl0dGVyOiBQYXJ0aWNsZUVtaXR0ZXI8R2xvYmFsU3RhdGU+O1xuICBwcml2YXRlIF9wb3NpdGlvbjogVmVjdG9yMjtcbiAgcHJpdmF0ZSBfdmVsb2NpdHk6IFZlY3RvcjI7XG4gIHByaXZhdGUgX3JvdGF0aW9uVmVjdG9yOiBWZWN0b3IyO1xuICBwcml2YXRlIF9yb3RhdGlvbjogbnVtYmVyO1xuICBwcml2YXRlIF9leHBsb3Npb25Db3VudDogbnVtYmVyID0gMDtcbiAgcHJpdmF0ZSBfaXNFeHBsb2Rpbmc6IGJvb2xlYW47XG5cbiAgZnVlbDogbnVtYmVyID0gMTAwO1xuICBjcmFzaGVkOiBib29sZWFuID0gZmFsc2U7XG4gIHRocnVzdGluZzogYm9vbGVhbiA9IGZhbHNlO1xuICB0dXJuaW5nTGVmdDogYm9vbGVhbiA9IGZhbHNlO1xuICB0dXJuaW5nUmlnaHQ6IGJvb2xlYW4gPSBmYWxzZTtcblxuICBjb25zdHJ1Y3Rvcihwb3NpdGlvbjogVmVjdG9yMiwgdGV4dHVyZTogVGV4dHVyZSwgc2l6ZTogVmVjdG9yMikge1xuICAgIHRoaXMudGV4dHVyZSA9IHRleHR1cmU7XG4gICAgdGhpcy5zaXplID0gc2l6ZTtcbiAgICB0aGlzLmZyb3plbiA9IGZhbHNlO1xuICAgIHRoaXMuX3Bvc2l0aW9uID0gcG9zaXRpb247XG4gICAgdGhpcy5fdmVsb2NpdHkgPSBuZXcgVmVjdG9yMigwLCAwKTtcbiAgICB0aGlzLl9yb3RhdGlvblZlY3RvciA9IG5ldyBWZWN0b3IyKDAsIC0xKTtcbiAgICB0aGlzLl9yb3RhdGlvbiA9IDA7XG4gICAgdGhpcy50aHJ1c3RFbWl0dGVyID0gbmV3IFBhcnRpY2xlRW1pdHRlcihcbiAgICAgIG5ldyBUaHJ1c3RHZW5lcmF0b3IoKSxcbiAgICAgIChzdGF0ZSkgPT4gc3RhdGUubGFuZGVyLnRocnVzdGluZyAmJiBzdGF0ZS5sYW5kZXIuZnVlbCA+IDAsXG4gICAgICAwLjA1LFxuICAgICAgMTBcbiAgICApO1xuICAgIHRoaXMubGVmdFJvdGF0aW9uRW1pdHRlciA9IG5ldyBQYXJ0aWNsZUVtaXR0ZXIoXG4gICAgICBuZXcgVGhydXN0R2VuZXJhdG9yKDkwKSxcbiAgICAgIChzdGF0ZSkgPT4gc3RhdGUubGFuZGVyLnR1cm5pbmdMZWZ0ICYmIHN0YXRlLmxhbmRlci5mdWVsID4gMCxcbiAgICAgIDAuMDUsXG4gICAgICA1XG4gICAgKTtcbiAgICB0aGlzLnJpZ2h0Um90YXRpb25FbWl0dGVyID0gbmV3IFBhcnRpY2xlRW1pdHRlcihcbiAgICAgIG5ldyBUaHJ1c3RHZW5lcmF0b3IoLTkwKSxcbiAgICAgIChzdGF0ZSkgPT4gc3RhdGUubGFuZGVyLnR1cm5pbmdSaWdodCAmJiBzdGF0ZS5sYW5kZXIuZnVlbCA+IDAsXG4gICAgICAwLjA1LFxuICAgICAgNVxuICAgICk7XG4gICAgdGhpcy5leHBsb3Npb25FbWl0dGVyID0gbmV3IFBhcnRpY2xlRW1pdHRlcihcbiAgICAgIG5ldyBFeHBsb3Npb25HZW5lcmF0b3IoKSxcbiAgICAgIChzdGF0ZSkgPT4gdGhpcy5faXNFeHBsb2RpbmcsXG4gICAgICAwLjEsXG4gICAgICA0MDBcbiAgICApO1xuICAgIHRoaXMucG9zaXRpb25FbWl0dGVycygpO1xuICB9XG5cbiAgZHJhdyhcbiAgICBjb250ZXh0OiBDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQsXG4gICAgc3RhdGU6IEdsb2JhbFN0YXRlLFxuICAgIGNvb3JkaW5hdGVzOiBDb29yZGluYXRlVHJhbnNsYXRhYmxlXG4gICkge1xuICAgIGlmICghc3RhdGUubGFuZGVyLmNyYXNoZWQpIHtcbiAgICAgIGRyYXdUZXh0dXJlKFxuICAgICAgICBjb250ZXh0LFxuICAgICAgICB0aGlzLnRleHR1cmUsXG4gICAgICAgIGNvb3JkaW5hdGVzLnRyYW5zbGF0ZSh0aGlzLl9wb3NpdGlvbiksXG4gICAgICAgIGNvb3JkaW5hdGVzLnRyYW5zbGF0ZSh0aGlzLnNpemUpLFxuICAgICAgICB0aGlzLl9yb3RhdGlvblxuICAgICAgKTtcbiAgICB9XG4gICAgdGhpcy50aHJ1c3RFbWl0dGVyLmRyYXcoY29udGV4dCwgc3RhdGUsIGNvb3JkaW5hdGVzKTtcbiAgICB0aGlzLmxlZnRSb3RhdGlvbkVtaXR0ZXIuZHJhdyhjb250ZXh0LCBzdGF0ZSwgY29vcmRpbmF0ZXMpO1xuICAgIHRoaXMucmlnaHRSb3RhdGlvbkVtaXR0ZXIuZHJhdyhjb250ZXh0LCBzdGF0ZSwgY29vcmRpbmF0ZXMpO1xuICAgIHRoaXMuZXhwbG9zaW9uRW1pdHRlci5kcmF3KGNvbnRleHQsIHN0YXRlLCBjb29yZGluYXRlcyk7XG4gICAgLy8gdGhpcy5kZWJ1Z0RyYXcoY29udGV4dCwgc3RhdGUsIGNvb3JkaW5hdGVzKTtcbiAgfVxuXG4gIHByaXZhdGUgZGVidWdEcmF3KFxuICAgIGNvbnRleHQ6IENhbnZhc1JlbmRlcmluZ0NvbnRleHQyRCxcbiAgICBzdGF0ZTogR2xvYmFsU3RhdGUsXG4gICAgY29vcmRpbmF0ZXM6IENvb3JkaW5hdGVUcmFuc2xhdGFibGVcbiAgKSB7XG4gICAgLy8gRGVidWcgY29sbGlzaW9uXG4gICAgY29udGV4dC5iZWdpblBhdGgoKTtcbiAgICBjb250ZXh0LnN0cm9rZVN0eWxlID0gXCIjZmZmZmZmXCI7XG4gICAgbGV0IGNpcmNsZXBvcyA9IGNvb3JkaW5hdGVzLnRyYW5zbGF0ZSh0aGlzLl9wb3NpdGlvbik7XG4gICAgY29udGV4dC5hcmMoXG4gICAgICBjaXJjbGVwb3MueCxcbiAgICAgIGNpcmNsZXBvcy55LFxuICAgICAgY29vcmRpbmF0ZXMudHJhbnNsYXRlKG5ldyBWZWN0b3IyKDQsIDApKS54LFxuICAgICAgMCxcbiAgICAgIE1hdGguUEkgKiAyXG4gICAgKTtcbiAgICBjb250ZXh0LnN0cm9rZSgpO1xuICAgIGxldCBhZGpQb3MgPSBjb29yZGluYXRlcy50cmFuc2xhdGUodGhpcy5fcG9zaXRpb24pO1xuXG4gICAgLy8gRGVidWcgcm90YXRpb25cbiAgICBsZXQgYWRqVmVjID0gY29vcmRpbmF0ZXMudHJhbnNsYXRlKHRoaXMuX3JvdGF0aW9uVmVjdG9yLnNjYWxlKDUpKTtcbiAgICBjb250ZXh0LmJlZ2luUGF0aCgpO1xuICAgIGlmICh0aGlzLl9yb3RhdGlvbiAlIDM2MCA8IDUgJiYgdGhpcy5fcm90YXRpb24gJSAzNjAgPiAtNSkge1xuICAgICAgY29udGV4dC5zdHJva2VTdHlsZSA9IFwiIzAwZmYwMFwiO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb250ZXh0LnN0cm9rZVN0eWxlID0gXCIjZmYwMDAwXCI7XG4gICAgfVxuICAgIGNvbnRleHQubGluZVRvKGFkalBvcy54LCBhZGpQb3MueSk7XG4gICAgY29udGV4dC5saW5lVG8oYWRqUG9zLnggKyBhZGpWZWMueCwgYWRqUG9zLnkgKyBhZGpWZWMueSk7XG4gICAgY29udGV4dC5zdHJva2UoKTtcblxuICAgIC8vIERlYnVnIHZlbG9jaXR5XG4gICAgbGV0IHZlbG9jaXR5ID0gY29vcmRpbmF0ZXMudHJhbnNsYXRlKHRoaXMuX3ZlbG9jaXR5Lm5vcm1hbGl6ZSgpLnNjYWxlKDUpKTtcbiAgICBjb250ZXh0LmJlZ2luUGF0aCgpO1xuICAgIGlmICh0aGlzLl92ZWxvY2l0eS5zcXJNYWduaXR1ZGUoKSA8IDQpIHtcbiAgICAgIGNvbnRleHQuc3Ryb2tlU3R5bGUgPSBcIiMwMDAwZmZcIjtcbiAgICB9IGVsc2Uge1xuICAgICAgY29udGV4dC5zdHJva2VTdHlsZSA9IFwiI2ZmMDAwMFwiO1xuICAgIH1cbiAgICBjb250ZXh0LmxpbmVUbyhhZGpQb3MueCwgYWRqUG9zLnkpO1xuICAgIGNvbnRleHQubGluZVRvKGFkalBvcy54ICsgdmVsb2NpdHkueCwgYWRqUG9zLnkgKyB2ZWxvY2l0eS55KTtcbiAgICBjb250ZXh0LnN0cm9rZSgpO1xuICB9XG5cbiAgcG9zaXRpb25FbWl0dGVycygpOiB2b2lkIHtcbiAgICB0aGlzLnRocnVzdEVtaXR0ZXIucG9zaXRpb24gPSB0aGlzLl9wb3NpdGlvbi5hZGQoXG4gICAgICB0aGlzLl9yb3RhdGlvblZlY3Rvci5zY2FsZSgtMylcbiAgICApO1xuICAgIHRoaXMubGVmdFJvdGF0aW9uRW1pdHRlci5wb3NpdGlvbiA9IHRoaXMuX3Bvc2l0aW9uLmFkZChcbiAgICAgIHRoaXMuX3JvdGF0aW9uVmVjdG9yLnJvdGF0ZSg3MCkuc2NhbGUoLTMuNSlcbiAgICApO1xuICAgIHRoaXMucmlnaHRSb3RhdGlvbkVtaXR0ZXIucG9zaXRpb24gPSB0aGlzLl9wb3NpdGlvbi5hZGQoXG4gICAgICB0aGlzLl9yb3RhdGlvblZlY3Rvci5yb3RhdGUoLTcwKS5zY2FsZSgtMy41KVxuICAgICk7XG4gICAgdGhpcy5leHBsb3Npb25FbWl0dGVyLnBvc2l0aW9uID0gdGhpcy5fcG9zaXRpb247XG4gIH1cblxuICB1cGRhdGUoZGVsdGE6IG51bWJlciwgc3RhdGU6IEdsb2JhbFN0YXRlKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuX2lzRXhwbG9kaW5nKSB7XG4gICAgICB0aGlzLl9leHBsb3Npb25Db3VudCsrO1xuICAgIH1cbiAgICBpZiAodGhpcy5fZXhwbG9zaW9uQ291bnQgPiA1KSB7XG4gICAgICB0aGlzLl9pc0V4cGxvZGluZyA9IGZhbHNlO1xuICAgIH1cbiAgICB0aGlzLnRocnVzdEVtaXR0ZXIudXBkYXRlKGRlbHRhLCBzdGF0ZSk7XG4gICAgdGhpcy5sZWZ0Um90YXRpb25FbWl0dGVyLnVwZGF0ZShkZWx0YSwgc3RhdGUpO1xuICAgIHRoaXMucmlnaHRSb3RhdGlvbkVtaXR0ZXIudXBkYXRlKGRlbHRhLCBzdGF0ZSk7XG4gICAgdGhpcy5leHBsb3Npb25FbWl0dGVyLnVwZGF0ZShkZWx0YSwgc3RhdGUpO1xuICAgIGlmICghdGhpcy5mcm96ZW4pIHtcbiAgICAgIGlmICh0aGlzLnR1cm5pbmdMZWZ0ICYmIHRoaXMuZnVlbCA+IDApIHtcbiAgICAgICAgdGhpcy5yb3RhdGUoZGVsdGEsIHN0YXRlLCAtMSk7XG4gICAgICB9XG4gICAgICBpZiAodGhpcy50dXJuaW5nUmlnaHQgJiYgdGhpcy5mdWVsID4gMCkge1xuICAgICAgICB0aGlzLnJvdGF0ZShkZWx0YSwgc3RhdGUsIDEpO1xuICAgICAgfVxuICAgICAgdGhpcy5fdmVsb2NpdHkgPSB0aGlzLl92ZWxvY2l0eS5hZGQoc3RhdGUuY29uZmlnLmdyYXZpdHkuc2NhbGUoZGVsdGEpKTtcbiAgICAgIGlmICh0aGlzLnRocnVzdGluZyAmJiB0aGlzLmZ1ZWwgPiAwKSB7XG4gICAgICAgIHRoaXMuX3ZlbG9jaXR5ID0gdGhpcy5fdmVsb2NpdHkuYWRkKFxuICAgICAgICAgIHRoaXMuX3JvdGF0aW9uVmVjdG9yLnNjYWxlKGRlbHRhICogc3RhdGUuY29uZmlnLnRocnVzdENvZWZmaWNpZW50KVxuICAgICAgICApO1xuICAgICAgICB0aGlzLmZ1ZWwgLT0gc3RhdGUuY29uZmlnLmZ1ZWxDb25zdW1wdGlvbiAqIGRlbHRhO1xuICAgICAgfVxuICAgICAgaWYgKHRoaXMuZnVlbCA8IDApIHtcbiAgICAgICAgdGhpcy5mdWVsID0gMDtcbiAgICAgICAgc3RhdGUuY29tbWFuZHMuZXhlY3V0ZSgnZnVlbEV4cGlyZWQnLCBzdGF0ZSk7XG4gICAgICB9XG4gICAgICB0aGlzLl9wb3NpdGlvbiA9IHRoaXMuX3Bvc2l0aW9uLmFkZCh0aGlzLl92ZWxvY2l0eS5zY2FsZShkZWx0YSkpO1xuICAgICAgdGhpcy5wb3NpdGlvbkVtaXR0ZXJzKCk7XG4gICAgICAvLyB0aGlzLnRocnVzdEVtaXR0ZXIudXBkYXRlKGRlbHRhLCBzdGF0ZSk7XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHN0YXRlLnRlcnJhaW4ucG9pbnRzLmxlbmd0aCAtIDE7IGkrKykge1xuICAgICAgICBpZiAoXG4gICAgICAgICAgaXNDb2xsaWRpbmcoXG4gICAgICAgICAgICBuZXcgQ2lyY2xlKHRoaXMuX3Bvc2l0aW9uLCA0KSxcbiAgICAgICAgICAgIHN0YXRlLnRlcnJhaW4ucG9pbnRzW2ldLFxuICAgICAgICAgICAgc3RhdGUudGVycmFpbi5wb2ludHNbaSArIDFdXG4gICAgICAgICAgKVxuICAgICAgICApIHtcbiAgICAgICAgICBpZiAoXG4gICAgICAgICAgICB0aGlzLnZlbG9jaXR5LnNxck1hZ25pdHVkZSgpIDw9IDQgJiZcbiAgICAgICAgICAgICh0aGlzLnJvdGF0aW9uIDwgNSB8fCB0aGlzLnJvdGF0aW9uID4gMzU1KVxuICAgICAgICAgICkge1xuICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBzdGF0ZS5zYWZlWm9uZXMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgaWYgKFxuICAgICAgICAgICAgICAgIHN0YXRlLnRlcnJhaW4ucG9pbnRzW2ldID09IHN0YXRlLnNhZmVab25lc1tqXVswXSAmJlxuICAgICAgICAgICAgICAgIHN0YXRlLnRlcnJhaW4ucG9pbnRzW2kgKyAxXSA9PSBzdGF0ZS5zYWZlWm9uZXNbal1bMV1cbiAgICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgc3RhdGUuY29tbWFuZHMuZXhlY3V0ZShcInNhZmVMYW5kaW5nXCIsIHN0YXRlKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgc3RhdGUuY29tbWFuZHMuZXhlY3V0ZShcImNyYXNoTGFuZGluZ1wiLCBzdGF0ZSk7XG4gICAgICAgICAgdGhpcy5faXNFeHBsb2RpbmcgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGlmICh0aGlzLnBvc2l0aW9uLnggPiAxMTAgfHwgdGhpcy5wb3NpdGlvbi54IDwgLTEwKSB7XG4gICAgICAgIHN0YXRlLmNvbW1hbmRzLmV4ZWN1dGUoXCJjcmFzaExhbmRpbmdcIiwgc3RhdGUpO1xuICAgICAgICB0aGlzLl9pc0V4cGxvZGluZyA9IHRydWU7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSByb3RhdGUoZGVsdGE6IG51bWJlciwgc3RhdGU6IEdsb2JhbFN0YXRlLCBkaXJlY3Rpb246IG51bWJlcikge1xuICAgIHRoaXMuZnVlbCAtPSBzdGF0ZS5jb25maWcuZnVlbENvbnN1bXB0aW9uICogZGVsdGEgKiAwLjU7XG4gICAgdGhpcy5fcm90YXRpb24gKz0gZGlyZWN0aW9uICogc3RhdGUuY29uZmlnLnRoZXRhICogZGVsdGE7XG4gICAgdGhpcy5fcm90YXRpb25WZWN0b3IgPSB0aGlzLl9yb3RhdGlvblZlY3Rvci5yb3RhdGUoXG4gICAgICBkaXJlY3Rpb24gKiBzdGF0ZS5jb25maWcudGhldGEgKiBkZWx0YVxuICAgICk7XG4gIH1cblxuICBnZXQgdmVsb2NpdHkoKTogVmVjdG9yMiB7XG4gICAgcmV0dXJuIHRoaXMuX3ZlbG9jaXR5O1xuICB9XG5cbiAgZ2V0IHJvdGF0aW9uKCk6IG51bWJlciB7XG4gICAgcmV0dXJuICgodGhpcy5fcm90YXRpb24gJSAzNjApICsgMzYwKSAlIDM2MDtcbiAgfVxuXG4gIGdldCByb3RhdGlvblZlY3RvcigpOiBWZWN0b3IyIHtcbiAgICByZXR1cm4gdGhpcy5fcm90YXRpb25WZWN0b3I7XG4gIH1cblxuICBnZXQgcG9zaXRpb24oKTogVmVjdG9yMiB7XG4gICAgcmV0dXJuIHRoaXMuX3Bvc2l0aW9uO1xuICB9XG5cbiAgcHVibGljIGZyZWV6ZSgpIHtcbiAgICB0aGlzLmZyb3plbiA9IHRydWU7XG4gICAgdGhpcy5fdmVsb2NpdHkgPSBWZWN0b3IyLlpFUk87XG4gIH1cbn1cbiIsImludGVyZmFjZSBNb2RpZmllcnMge1xuICBhbHQ6IGJvb2xlYW47XG4gIHNoaWZ0OiBib29sZWFuO1xuICBjdHJsOiBib29sZWFuO1xufVxuXG5pbnRlcmZhY2UgS2V5UmVzcG9uc2Uge1xuICAocHJlc3NlZDogYm9vbGVhbiwgdGltZURlbHRhOiBudW1iZXIsIG1vZGlmaWVyczogTW9kaWZpZXJzKTogdm9pZDtcbn1cblxuY2xhc3MgS2V5SGFuZGxlciB7XG4gIHByaXZhdGUgX3dhc1ByZXNzZWQ6IGJvb2xlYW4gPSBmYWxzZTtcbiAgcHJpdmF0ZSBfbGFzdFByZXNzZWQ6IG51bWJlciA9IERhdGUubm93KCk7XG4gIHByaXZhdGUgX29uU3RhdGVDaGFuZ2VkOiBTZXQ8S2V5UmVzcG9uc2U+ID0gbmV3IFNldCgpO1xuICBwcml2YXRlIF9vbktleVVwOiBTZXQ8S2V5UmVzcG9uc2U+ID0gbmV3IFNldCgpO1xuICBwcml2YXRlIF9vbktleURvd246IFNldDxLZXlSZXNwb25zZT4gPSBuZXcgU2V0KCk7XG5cbiAgdXBkYXRlKHByZXNzZWQ6IGJvb2xlYW4sIG1vZGlmaWVyczogTW9kaWZpZXJzKSB7XG4gICAgaWYgKHRoaXMuX3dhc1ByZXNzZWQgIT0gcHJlc3NlZCkge1xuICAgICAgLy8gSW5pdCBzZXRcbiAgICAgIGxldCBzZXQ7XG4gICAgICBpZiAocHJlc3NlZCkge1xuICAgICAgICBzZXQgPSB0aGlzLl9vbktleURvd247XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzZXQgPSB0aGlzLl9vbktleVVwO1xuICAgICAgfVxuXG4gICAgICAvLyBUaW1lIGRlbHRhXG4gICAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xuXG4gICAgICAvLyBIYW5kbGVyc1xuICAgICAgZm9yIChsZXQgcmVzIG9mIHNldCkge1xuICAgICAgICByZXMocHJlc3NlZCwgbm93IC0gdGhpcy5fbGFzdFByZXNzZWQsIG1vZGlmaWVycyk7XG4gICAgICB9XG4gICAgICBmb3IgKGxldCByZXMgb2YgdGhpcy5fb25TdGF0ZUNoYW5nZWQpIHtcbiAgICAgICAgcmVzKHByZXNzZWQsIG5vdyAtIHRoaXMuX2xhc3RQcmVzc2VkLCBtb2RpZmllcnMpO1xuICAgICAgfVxuXG4gICAgICAvLyBVcGRhdGVzXG4gICAgICB0aGlzLl9sYXN0UHJlc3NlZCA9IG5vdztcbiAgICAgIHRoaXMuX3dhc1ByZXNzZWQgPSAhdGhpcy5fd2FzUHJlc3NlZDtcbiAgICB9XG4gIH1cblxuICBhZGRVcChhY3Rpb246IEtleVJlc3BvbnNlKSB7XG4gICAgdGhpcy5fb25LZXlVcC5hZGQoYWN0aW9uKTtcbiAgfVxuICBhZGREb3duKGFjdGlvbjogS2V5UmVzcG9uc2UpIHtcbiAgICB0aGlzLl9vbktleURvd24uYWRkKGFjdGlvbik7XG4gIH1cbiAgYWRkQ2hhbmdlZChhY3Rpb246IEtleVJlc3BvbnNlKSB7XG4gICAgdGhpcy5fb25TdGF0ZUNoYW5nZWQuYWRkKGFjdGlvbik7XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIEtleU1hbmFnZXIge1xuICBwcml2YXRlIGhhbmRsZXJzOiBNYXA8c3RyaW5nLCBLZXlIYW5kbGVyPjtcbiAgcHJpdmF0ZSBkZXNjcmlwdGlvbnM6IE1hcDxzdHJpbmcsIHN0cmluZz47XG4gIHB1YmxpYyByZWdpc3RlckhhbmRsZXIoa2V5Q29kZTogc3RyaW5nLCBkZXNjcmlwdGlvbj86IHN0cmluZykge1xuICAgIGlmICghdGhpcy5oYW5kbGVycy5oYXMoa2V5Q29kZSkpIHtcbiAgICAgIHRoaXMuaGFuZGxlcnMuc2V0KGtleUNvZGUsIG5ldyBLZXlIYW5kbGVyKCkpO1xuICAgICAgdGhpcy5kZXNjcmlwdGlvbnM/LnNldChrZXlDb2RlLCBkZXNjcmlwdGlvbik7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnNvbGUud2FybihgS2V5IGhhbmRsZXIgcmVnaXN0ZXJlZCB0d2ljZSBmb3Iga2V5Q29kZSAke2tleUNvZGV9YCk7XG4gICAgfVxuICB9XG4gIGJpbmRVcChrZXlDb2RlOiBzdHJpbmcsIHVwZGF0ZUZuOiBLZXlSZXNwb25zZSkge1xuICAgIHRoaXMuaGFuZGxlcnMuZ2V0KGtleUNvZGUpLmFkZFVwKHVwZGF0ZUZuKTtcbiAgfVxuICBiaW5kRG93bihrZXlDb2RlOiBzdHJpbmcsIHVwZGF0ZUZuOiBLZXlSZXNwb25zZSkge1xuICAgIHRoaXMuaGFuZGxlcnMuZ2V0KGtleUNvZGUpLmFkZERvd24odXBkYXRlRm4pO1xuICB9XG4gIGJpbmRDaGFuZ2VkKGtleUNvZGU6IHN0cmluZywgdXBkYXRlRm46IEtleVJlc3BvbnNlKSB7XG4gICAgdGhpcy5oYW5kbGVycy5nZXQoa2V5Q29kZSkuYWRkQ2hhbmdlZCh1cGRhdGVGbik7XG4gIH1cbiAgdXBkYXRlRG93bihldmVudDogS2V5Ym9hcmRFdmVudCkge1xuICAgIGNvbnNvbGUubG9nKGV2ZW50LmtleSk7XG4gICAgaWYgKHRoaXMuaGFuZGxlcnMuaGFzKGV2ZW50LmtleSkpIHtcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICBjb25zdCBoYW5kbGVyID0gdGhpcy5oYW5kbGVycy5nZXQoZXZlbnQua2V5KTtcbiAgICAgIGhhbmRsZXIudXBkYXRlKHRydWUsIHtcbiAgICAgICAgYWx0OiBldmVudC5hbHRLZXksXG4gICAgICAgIHNoaWZ0OiBldmVudC5zaGlmdEtleSxcbiAgICAgICAgY3RybDogZXZlbnQuY3RybEtleSxcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIHVwZGF0ZVVwKGV2ZW50OiBLZXlib2FyZEV2ZW50KSB7XG4gICAgaWYgKHRoaXMuaGFuZGxlcnMuaGFzKGV2ZW50LmtleSkpIHtcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICBjb25zdCBoYW5kbGVyID0gdGhpcy5oYW5kbGVycy5nZXQoZXZlbnQua2V5KTtcbiAgICAgIGhhbmRsZXIudXBkYXRlKGZhbHNlLCB7XG4gICAgICAgIGFsdDogZXZlbnQuYWx0S2V5LFxuICAgICAgICBzaGlmdDogZXZlbnQuc2hpZnRLZXksXG4gICAgICAgIGN0cmw6IGV2ZW50LmN0cmxLZXksXG4gICAgICB9KTtcbiAgICB9XG4gIH1cbiAgY2xlYXIoKSB7XG4gICAgdGhpcy5oYW5kbGVycyA9IG5ldyBNYXAoKTtcbiAgfVxuXG4gIHJlbW92ZShrZXljb2RlOiBzdHJpbmcpIHtcbiAgICB0aGlzLmhhbmRsZXJzLmRlbGV0ZShrZXljb2RlKTtcbiAgfVxuXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLnVwZGF0ZURvd24uYmluZCh0aGlzKSk7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXl1cFwiLCB0aGlzLnVwZGF0ZVVwLmJpbmQodGhpcykpO1xuICAgIHRoaXMuaGFuZGxlcnMgPSBuZXcgTWFwPHN0cmluZywgS2V5SGFuZGxlcj4oKTtcbiAgfVxufVxuIiwiaW50ZXJmYWNlIENvbW1hbmRSdW5uYWJsZTxUPiB7XG4gIChzdGF0ZTogVCk6IHZvaWQ7XG59XG5cbmNsYXNzIENvbW1hbmQ8VD4ge1xuICBwcml2YXRlIF9uYW1lOiBzdHJpbmc7XG4gIHByaXZhdGUgX2FjdGlvbjogQ29tbWFuZFJ1bm5hYmxlPFQ+O1xuICBjb25zdHJ1Y3RvcihuYW1lOiBzdHJpbmcsIGFjdGlvbjogQ29tbWFuZFJ1bm5hYmxlPFQ+KSB7XG4gICAgdGhpcy5fbmFtZSA9IG5hbWU7XG4gICAgdGhpcy5fYWN0aW9uID0gYWN0aW9uO1xuICB9XG5cbiAgcHVibGljIGdldCBuYW1lKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIHRoaXMuX25hbWU7XG4gIH1cblxuICBwdWJsaWMgaW52b2tlKHN0YXRlOiBUKTogdm9pZCB7XG4gICAgdGhpcy5fYWN0aW9uKHN0YXRlKTtcbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgQ29tbWFuZFNlcnZpY2U8VD4ge1xuICBwcml2YXRlIGNvbW1hbmRzOiBNYXA8c3RyaW5nLCBDb21tYW5kPFQ+PjtcblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLmNvbW1hbmRzID0gbmV3IE1hcDxzdHJpbmcsIENvbW1hbmQ8VD4+KCk7XG4gIH1cblxuICBwdWJsaWMgY3JlYXRlQ29tbWFuZChuYW1lOiBzdHJpbmcsIGFjdGlvbjogQ29tbWFuZFJ1bm5hYmxlPFQ+KTogdm9pZCB7XG4gICAgdGhpcy5jb21tYW5kcy5zZXQobmFtZSwgbmV3IENvbW1hbmQobmFtZSwgYWN0aW9uKSk7XG4gIH1cblxuICBwdWJsaWMgZXhlY3V0ZShuYW1lOiBzdHJpbmcsIHN0YXRlOiBUKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuY29tbWFuZHMuaGFzKG5hbWUpKSB7XG4gICAgICB0aGlzLmNvbW1hbmRzLmdldChuYW1lKS5pbnZva2Uoc3RhdGUpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zb2xlLndhcm4oYEF0dGVtcHRpbmcgdG8gaW52b2tlIG5vbi1leGlzdGVudCBjb21tYW5kICR7bmFtZX1gKTtcbiAgICB9XG4gIH1cbn1cbiIsImltcG9ydCBWZWN0b3IyIGZyb20gXCIuL3ZlY3RvcjJcIjtcbmltcG9ydCB7IHJhbmRvbSB9IGZyb20gXCIuL3JhbmRvbVwiO1xuaW1wb3J0IHsgQ29vcmRpbmF0ZVRyYW5zbGF0YWJsZSB9IGZyb20gXCIuL2Nvb3JkaW5hdGVcIjtcblxuZXhwb3J0IGZ1bmN0aW9uIGRyYXdUZXJyYWluKFxuICBjdHg6IENhbnZhc1JlbmRlcmluZ0NvbnRleHQyRCxcbiAgdGVycmFpbjogVGVycmFpbixcbiAgdmNzOiBDb29yZGluYXRlVHJhbnNsYXRhYmxlXG4pIHtcbiAgY3R4LmJlZ2luUGF0aCgpO1xuICBjdHgubGluZVRvKHZjcy50cmFuc2xhdGVWYWx1ZVgoMCksIHZjcy50cmFuc2xhdGVWYWx1ZVkoMTAwKSk7XG4gIGN0eC5zdHJva2VTdHlsZSA9IFwiI2ZmZmZmZlwiO1xuICBjdHguZmlsbFN0eWxlID0gXCIjZmZmZmZmXCI7XG4gIGZvciAobGV0IGkgPSAxOyBpIDwgdGVycmFpbi5wb2ludHMubGVuZ3RoOyBpKyspIHtcbiAgICBsZXQgcHQgPSB2Y3MudHJhbnNsYXRlKHRlcnJhaW4ucG9pbnRzW2ldKTtcbiAgICBjdHgubGluZVRvKHB0LngsIHB0LnkpO1xuICB9XG4gIGN0eC5saW5lVG8odmNzLnRyYW5zbGF0ZVZhbHVlWCgxMDApLCB2Y3MudHJhbnNsYXRlVmFsdWVZKDEwMCkpO1xuICBjdHguZmlsbCgpO1xufVxuXG5leHBvcnQgY2xhc3MgVGVycmFpbiB7XG4gIHBvaW50czogQXJyYXk8VmVjdG9yMj47XG4gIGNvbnN0cnVjdG9yKGl0ZXJhdGlvbnM6IG51bWJlciwgcm91Z2huZXNzOiBudW1iZXIsIHAxOiBWZWN0b3IyLCBwMjogVmVjdG9yMikge1xuICAgIHRoaXMucG9pbnRzID0gW3AxLCBwMl07XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpdGVyYXRpb25zOyBpKyspIHtcbiAgICAgIGxldCBzYXZlZExlbmd0aCA9IHRoaXMucG9pbnRzLmxlbmd0aDtcbiAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgc2F2ZWRMZW5ndGggLSAxOyBqKyspIHtcbiAgICAgICAgbGV0IG1pZCA9IG5ldyBWZWN0b3IyKFxuICAgICAgICAgICh0aGlzLnBvaW50c1tqICogMl0ueCArIHRoaXMucG9pbnRzW2ogKiAyICsgMV0ueCkgLyAyLFxuICAgICAgICAgICh0aGlzLnBvaW50c1tqICogMl0ueSArIHRoaXMucG9pbnRzW2ogKiAyICsgMV0ueSkgLyAyXG4gICAgICAgICk7XG4gICAgICAgIG1pZCA9IG1pZC5hZGQobmV3IFZlY3RvcjIoMCwgcmFuZG9tLmdhdXNzaWFuKDEyKSAqIHJvdWdobmVzcykpO1xuICAgICAgICB0aGlzLnBvaW50cy5zcGxpY2UoaiAqIDIgKyAxLCAwLCBtaWQpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGluc2VydFNhZmVab25lKG1pblg6IG51bWJlciwgbWF4WDogbnVtYmVyLCB3aWR0aDogbnVtYmVyKSB7XG4gICAgbGV0IHRhcmdldFhNaW4gPSBtaW5YICsgd2lkdGggLyAyO1xuICAgIGxldCB0YXJnZXRYTWF4ID0gbWF4WCAtIHdpZHRoIC8gMjtcbiAgICBsZXQgZGlmZiA9IHRhcmdldFhNYXggLSB0YXJnZXRYTWluO1xuICAgIGxldCBvZmZzZXQgPSB0YXJnZXRYTWluICsgZGlmZiAqIE1hdGgucmFuZG9tKCk7XG4gICAgbGV0IGkgPSAwO1xuICAgIGxldCBwb2ludCA9IHRoaXMucG9pbnRzWzBdO1xuICAgIHdoaWxlIChwb2ludC54IDwgb2Zmc2V0KSB7XG4gICAgICBwb2ludCA9IHRoaXMucG9pbnRzWysraV07XG4gICAgfVxuICAgIGxldCBzYXZlZCA9IHBvaW50O1xuICAgIGkrKztcbiAgICBwb2ludCA9IHRoaXMucG9pbnRzW2ldO1xuICAgIGxldCB4ID0gMDtcbiAgICB3aGlsZSAocG9pbnQueCA8IG9mZnNldCArIHdpZHRoKSB7XG4gICAgICB4ID0gcG9pbnQueDtcbiAgICAgIHRoaXMucG9pbnRzLnNwbGljZShpLCAxKTtcbiAgICAgIHBvaW50ID0gdGhpcy5wb2ludHNbaV07XG4gICAgfVxuICAgIHRoaXMucG9pbnRzW2ldID0gbmV3IFZlY3RvcjIoeCwgc2F2ZWQueSk7XG4gICAgcmV0dXJuIFtzYXZlZCwgdGhpcy5wb2ludHNbaV1dO1xuICB9XG59XG4iLCJleHBvcnQgY2xhc3MgU291bmRFZmZlY3Qge1xuICAgIHByaXZhdGUgZWw6IEhUTUxBdWRpb0VsZW1lbnQ7XG4gICAgcHJpdmF0ZSByZWFkeSA9IGZhbHNlO1xuICAgIHByaXZhdGUgY29udGludWUgPSBmYWxzZTtcbiAgICBwcml2YXRlIGxvb3AgPSBmYWxzZTtcbiAgICBwcml2YXRlIF9wbGF5aW5nID0gZmFsc2U7XG4gICAgcHJpdmF0ZSBjdXRvZmYgPSAwO1xuICAgIGNvbnN0cnVjdG9yKHNvdXJjZTogc3RyaW5nLCBjdXRvZmY/OiBudW1iZXIpIHtcbiAgICAgICAgdGhpcy5lbCA9IG5ldyBBdWRpbyhzb3VyY2UpO1xuICAgICAgICB0aGlzLmVsLmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLCAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnJlYWR5ID0gdHJ1ZTtcbiAgICAgICAgfSk7XG4gICAgICAgIGlmIChjdXRvZmYpIHtcbiAgICAgICAgICAgIHRoaXMubG9vcCA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLmN1dG9mZiA9IGN1dG9mZjtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHBsYXkoKSB7XG4gICAgICAgIHRoaXMuZWwucGxheSgpO1xuICAgICAgICB0aGlzLmNvbnRpbnVlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5fcGxheWluZyA9IHRydWU7XG4gICAgICAgIGlmICh0aGlzLmxvb3ApIHtcbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge2lmKCF0aGlzLmNvbnRpbnVlKSByZXR1cm47IHRoaXMuZWwuY3VycmVudFRpbWUgPSAwOyB0aGlzLnBsYXlSZWMoKX0sIHRoaXMuY3V0b2ZmICogMTAwMCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHRoaXMuX3BsYXlpbmcgPSBmYWxzZSwgdGhpcy5lbC5kdXJhdGlvbiAqIDEwMDApXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwbGF5UmVjKCkge1xuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtpZighdGhpcy5jb250aW51ZSkgcmV0dXJuOyB0aGlzLmVsLmN1cnJlbnRUaW1lID0gMDsgdGhpcy5wbGF5UmVjKCl9LCB0aGlzLmN1dG9mZiAqIDEwMDApO1xuICAgIH1cblxuICAgIHN0b3AoKSB7XG4gICAgICAgIHRoaXMuZWwucGF1c2UoKTtcbiAgICAgICAgdGhpcy5jb250aW51ZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLl9wbGF5aW5nID0gZmFsc2U7XG4gICAgICAgIHRoaXMuZWwuY3VycmVudFRpbWUgPSAwO1xuICAgIH1cblxuICAgIHB1YmxpYyBnZXQgcGxheWluZygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3BsYXlpbmc7XG4gICAgfVxufSIsImltcG9ydCBWZWN0b3IyIGZyb20gXCIuL3ZlY3RvcjJcIjtcbmltcG9ydCB7IGRyYXdUZXh0dXJlLCBUZXh0dXJlIH0gZnJvbSBcIi4vdGV4dHVyZVwiO1xuaW1wb3J0IERyYXdhYmxlIGZyb20gXCIuL2RyYXdhYmxlXCI7XG5pbXBvcnQgVGlja2luZyBmcm9tIFwiLi90aWNraW5nXCI7XG5pbXBvcnQgeyBWaXJ0dWFsQ29vcmRpbmF0ZVN5c3RlbSB9IGZyb20gXCIuL2Nvb3JkaW5hdGVcIjtcbmltcG9ydCB7IEdsb2JhbFN0YXRlIH0gZnJvbSBcIi4vc3RhdGVcIjtcbmltcG9ydCB7IExhbmRlciB9IGZyb20gXCIuL2xhbmRlclwiO1xuaW1wb3J0IHsgS2V5TWFuYWdlciB9IGZyb20gXCIuL2tleVwiO1xuaW1wb3J0IHsgQ29tbWFuZFNlcnZpY2UgfSBmcm9tIFwiLi9jb21tYW5kXCI7XG5pbXBvcnQgeyBkcmF3VGVycmFpbiwgVGVycmFpbiB9IGZyb20gXCIuL3RlcnJhaW5cIjtcbmltcG9ydCB7IENvbmRpdGlvbmFsRHJhd2FibGUgfSBmcm9tIFwiLi9jb25kaXRpb25hbERyYXdhYmxlXCI7XG5pbXBvcnQgeyBTb3VuZEVmZmVjdCB9IGZyb20gXCIuL3NvdW5kXCI7XG5cbi8vIEdlbmVyYWwgU2V0dXBcbmNvbnN0IGNhbnZhcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiY2FudmFzXCIpIGFzIEhUTUxDYW52YXNFbGVtZW50O1xuY29uc3QgY29udGV4dCA9IGNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIik7XG5jb25zdCBrZXlzID0gbmV3IEtleU1hbmFnZXIoKTtcbmNvbnN0IGNvbW1hbmRzID0gbmV3IENvbW1hbmRTZXJ2aWNlPEdsb2JhbFN0YXRlPigpO1xuY29uc3Qgd29ybGREaW1lbnNpb24gPSAxMDA7XG5jb25zdCB3b3JsZFNpemUgPSBuZXcgVmVjdG9yMih3b3JsZERpbWVuc2lvbiwgd29ybGREaW1lbnNpb24pO1xuY29uc3QgbGFuZGVyVGV4dHVyZSA9IG5ldyBUZXh0dXJlKFwiYXNzZXRzL0xhbmRlci5wbmdcIiwgbmV3IFZlY3RvcjIoNTAwLCA1MDApKTtcbmNvbnN0IHRlcnJhaW4gPSBuZXcgVGVycmFpbig1LCAxNSwgbmV3IFZlY3RvcjIoMCwgNzApLCBuZXcgVmVjdG9yMigxMDAsIDcwKSk7XG5jb25zdCBzYWZlWm9uZXMgPSBbXTtcbnNhZmVab25lcy5wdXNoKHRlcnJhaW4uaW5zZXJ0U2FmZVpvbmUoMTAsIDQwLCAxNSkpO1xuc2FmZVpvbmVzLnB1c2godGVycmFpbi5pbnNlcnRTYWZlWm9uZSg2MCwgOTAsIDE1KSk7XG5cbi8vIFZpcnR1YWwgU2l6aW5nXG5sZXQgbWF4Q29vcmQgPSBNYXRoLm1pbih3aW5kb3cuaW5uZXJXaWR0aCwgd2luZG93LmlubmVySGVpZ2h0KTtcbmNhbnZhcy53aWR0aCA9IG1heENvb3JkO1xuY2FudmFzLmhlaWdodCA9IG1heENvb3JkO1xubGV0IHZjcyA9IG5ldyBWaXJ0dWFsQ29vcmRpbmF0ZVN5c3RlbShcbiAgbWF4Q29vcmQgLyB3b3JsZFNpemUueCxcbiAgbWF4Q29vcmQgLyB3b3JsZFNpemUueVxuKTtcblxuLy8gUmVzaXplXG5mdW5jdGlvbiByZXNpemUoKSB7XG4gIG1heENvb3JkID0gTWF0aC5taW4od2luZG93LmlubmVyV2lkdGgsIHdpbmRvdy5pbm5lckhlaWdodCk7XG5cbiAgY2FudmFzLndpZHRoID0gbWF4Q29vcmQ7XG4gIGNhbnZhcy5oZWlnaHQgPSBtYXhDb29yZDtcblxuICB2Y3MgPSBuZXcgVmlydHVhbENvb3JkaW5hdGVTeXN0ZW0oXG4gICAgbWF4Q29vcmQgLyB3b3JsZFNpemUueCxcbiAgICBtYXhDb29yZCAvIHdvcmxkU2l6ZS55XG4gICk7XG4gIGNvbnNvbGUubG9nKGBSZXNpemluZyB0byAke21heENvb3JkfXB4LmApO1xufVxuXG53aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcInJlc2l6ZVwiLCByZXNpemUpO1xuXG5jb25zdCBsYW5kZXIgPSBuZXcgTGFuZGVyKFxuICBuZXcgVmVjdG9yMih3b3JsZFNpemUueCAvIDIsIDApLFxuICBsYW5kZXJUZXh0dXJlLFxuICBuZXcgVmVjdG9yMigxMCwgMTApXG4pO1xuXG5jb25zdCBkcmF3YWJsZXMgPSBuZXcgQXJyYXk8RHJhd2FibGU8R2xvYmFsU3RhdGU+PigpO1xuY29uc3QgdGlja2luZyA9IG5ldyBBcnJheTxUaWNraW5nPEdsb2JhbFN0YXRlPj4oKTtcblxuLy8gQ29tbWFuZCBDcmVhdGlvblxuY29tbWFuZHMuY3JlYXRlQ29tbWFuZChcImVuYWJsZVRocnVzdFwiLCAoZ2xvYmFsU3RhdGUpID0+IHtcbiAgICBnbG9iYWxTdGF0ZS5sYW5kZXIudGhydXN0aW5nID0gdHJ1ZTtcbiAgaWYgKGdsb2JhbFN0YXRlLmxhbmRlci5mdWVsID4gMCkge1xuICAgIGdsb2JhbFN0YXRlLnNvdW5kcy5tYWluVGhydXN0ZXIucGxheSgpO1xuICB9XG4gIGVsc2Uge1xuICAgIGdsb2JhbFN0YXRlLnNvdW5kcy5ub0Z1ZWwucGxheSgpO1xuICB9XG59KTtcblxuY29tbWFuZHMuY3JlYXRlQ29tbWFuZChcImRpc2FibGVUaHJ1c3RcIiwgKGdsb2JhbFN0YXRlKSA9PiB7XG4gIGdsb2JhbFN0YXRlLmxhbmRlci50aHJ1c3RpbmcgPSBmYWxzZTtcbiAgZ2xvYmFsU3RhdGUuc291bmRzLm1haW5UaHJ1c3Rlci5zdG9wKCk7XG4gIGdsb2JhbFN0YXRlLnNvdW5kcy5ub0Z1ZWwuc3RvcCgpO1xufSk7XG5cbmNvbW1hbmRzLmNyZWF0ZUNvbW1hbmQoXCJmdWVsRXhwaXJlZFwiLCAoZ2xvYmFsU3RhdGUpID0+IHtcbiAgaWYoZ2xvYmFsU3RhdGUuc291bmRzLm1haW5UaHJ1c3Rlci5wbGF5aW5nKSB7XG4gICAgZ2xvYmFsU3RhdGUuc291bmRzLm1haW5UaHJ1c3Rlci5zdG9wKCk7XG4gICAgZ2xvYmFsU3RhdGUuc291bmRzLm5vRnVlbC5wbGF5KCk7XG4gIH1cbiAgaWYoZ2xvYmFsU3RhdGUuc291bmRzLnN1YlRocnVzdGVyLnBsYXlpbmcpIHtcbiAgICBnbG9iYWxTdGF0ZS5zb3VuZHMuc3ViVGhydXN0ZXIuc3RvcCgpO1xuICAgIGdsb2JhbFN0YXRlLnNvdW5kcy5ub0Z1ZWwucGxheSgpO1xuICB9XG5cbn0pXG5cbmNvbW1hbmRzLmNyZWF0ZUNvbW1hbmQoXCJiZWdpblR1cm5MZWZ0XCIsIChnbG9iYWxTdGF0ZSkgPT4ge1xuICBnbG9iYWxTdGF0ZS5sYW5kZXIudHVybmluZ0xlZnQgPSB0cnVlO1xuICBpZiAoZ2xvYmFsU3RhdGUubGFuZGVyLmZ1ZWwgPiAwKSB7XG4gICAgZ2xvYmFsU3RhdGUuc291bmRzLnN1YlRocnVzdGVyLnBsYXkoKTtcbiAgfVxuICBlbHNlIHtcbiAgICBnbG9iYWxTdGF0ZS5zb3VuZHMubm9GdWVsLnBsYXkoKTtcbiAgfVxufSk7XG5cbmNvbW1hbmRzLmNyZWF0ZUNvbW1hbmQoXCJlbmRUdXJuTGVmdFwiLCAoZ2xvYmFsU3RhdGUpID0+IHtcbiAgZ2xvYmFsU3RhdGUuc291bmRzLnN1YlRocnVzdGVyLnN0b3AoKTtcbiAgZ2xvYmFsU3RhdGUuc291bmRzLm5vRnVlbC5zdG9wKCk7XG4gIGdsb2JhbFN0YXRlLmxhbmRlci50dXJuaW5nTGVmdCA9IGZhbHNlO1xufSk7XG5cbmNvbW1hbmRzLmNyZWF0ZUNvbW1hbmQoXCJiZWdpblR1cm5SaWdodFwiLCAoZ2xvYmFsU3RhdGUpID0+IHtcbiAgaWYgKGdsb2JhbFN0YXRlLmxhbmRlci5mdWVsID4gMCkge1xuICAgIGdsb2JhbFN0YXRlLnNvdW5kcy5zdWJUaHJ1c3Rlci5wbGF5KCk7XG4gIH1cbiAgZWxzZSB7XG4gICAgZ2xvYmFsU3RhdGUuc291bmRzLm5vRnVlbC5wbGF5KCk7XG4gIH1cbiAgZ2xvYmFsU3RhdGUubGFuZGVyLnR1cm5pbmdSaWdodCA9IHRydWU7XG59KTtcblxuY29tbWFuZHMuY3JlYXRlQ29tbWFuZChcImVuZFR1cm5SaWdodFwiLCAoZ2xvYmFsU3RhdGUpID0+IHtcbiAgZ2xvYmFsU3RhdGUuc291bmRzLnN1YlRocnVzdGVyLnN0b3AoKTtcbiAgZ2xvYmFsU3RhdGUuc291bmRzLm5vRnVlbC5zdG9wKCk7XG4gIGdsb2JhbFN0YXRlLmxhbmRlci50dXJuaW5nUmlnaHQgPSBmYWxzZTtcbn0pO1xuXG5jb21tYW5kcy5jcmVhdGVDb21tYW5kKFwic2FmZUxhbmRpbmdcIiwgKGdsb2JhbFN0YXRlKSA9PiB7XG4gIGdsb2JhbFN0YXRlLnNvdW5kcy5sYW5kaW5nLnBsYXkoKTtcbiAgZ2xvYmFsU3RhdGUubGFuZGVyLmZyZWV6ZSgpO1xufSk7XG5cbmNvbW1hbmRzLmNyZWF0ZUNvbW1hbmQoXCJjcmFzaExhbmRpbmdcIiwgKGdsb2JhbFN0YXRlKSA9PiB7XG4gIGdsb2JhbFN0YXRlLnNvdW5kcy5leHBsb3Npb24ucGxheSgpO1xuICBnbG9iYWxTdGF0ZS5sYW5kZXIuY3Jhc2hlZCA9IHRydWU7XG4gIGdsb2JhbFN0YXRlLmxhbmRlci5mcmVlemUoKTtcbn0pO1xuXG4vLyBEZWZhdWx0IEtleWJpbmRpbmdzXG5rZXlzLnJlZ2lzdGVySGFuZGxlcihcIiBcIik7XG5rZXlzLnJlZ2lzdGVySGFuZGxlcihcInFcIik7XG5rZXlzLnJlZ2lzdGVySGFuZGxlcihcImVcIik7XG5rZXlzLmJpbmREb3duKFwiIFwiLCAoKSA9PiBjb21tYW5kcy5leGVjdXRlKFwiZW5hYmxlVGhydXN0XCIsIGdsb2JhbFN0YXRlKSk7XG5rZXlzLmJpbmRVcChcIiBcIiwgKCkgPT4gY29tbWFuZHMuZXhlY3V0ZShcImRpc2FibGVUaHJ1c3RcIiwgZ2xvYmFsU3RhdGUpKTtcbmtleXMuYmluZERvd24oXCJxXCIsICgpID0+IGNvbW1hbmRzLmV4ZWN1dGUoXCJiZWdpblR1cm5MZWZ0XCIsIGdsb2JhbFN0YXRlKSk7XG5rZXlzLmJpbmRVcChcInFcIiwgKCkgPT4gY29tbWFuZHMuZXhlY3V0ZShcImVuZFR1cm5MZWZ0XCIsIGdsb2JhbFN0YXRlKSk7XG5rZXlzLmJpbmREb3duKFwiZVwiLCAoKSA9PiBjb21tYW5kcy5leGVjdXRlKFwiYmVnaW5UdXJuUmlnaHRcIiwgZ2xvYmFsU3RhdGUpKTtcbmtleXMuYmluZFVwKFwiZVwiLCAoKSA9PiBjb21tYW5kcy5leGVjdXRlKFwiZW5kVHVyblJpZ2h0XCIsIGdsb2JhbFN0YXRlKSk7XG5cbi8vIFN0YXRlIEluaXRpYWxpemF0aW9uXG5sZXQgZ2xvYmFsU3RhdGU6IEdsb2JhbFN0YXRlID0ge1xuICB0ZXJyYWluLFxuICBsYW5kZXIsXG4gIHNhZmVab25lcyxcbiAgY29tbWFuZHMsXG4gIGtleXMsXG4gIGNvbmZpZzoge1xuICAgIGZ1ZWxDb25zdW1wdGlvbjogMjAsXG4gICAgdGhydXN0Q29lZmZpY2llbnQ6IDEwLFxuICAgIHRoZXRhOiA5MCxcbiAgICBncmF2aXR5OiBuZXcgVmVjdG9yMigwLCAxKSxcbiAgfSxcbiAgc291bmRzOiB7XG4gICAgbWFpblRocnVzdGVyOiBuZXcgU291bmRFZmZlY3QoJ2Fzc2V0cy9tYWludGhydXN0ZXIud2F2JywgNCksXG4gICAgc3ViVGhydXN0ZXI6IG5ldyBTb3VuZEVmZmVjdCgnYXNzZXRzL3N1YnRocnVzdGVyLndhdicsIDQpLFxuICAgIGV4cGxvc2lvbjogbmV3IFNvdW5kRWZmZWN0KCdhc3NldHMvZXhwbG9zaW9uLndhdicpLFxuICAgIGxhbmRpbmc6IG5ldyBTb3VuZEVmZmVjdCgnYXNzZXRzL2xhbmRpbmcud2F2JyksXG4gICAgbm9GdWVsOiBuZXcgU291bmRFZmZlY3QoJ2Fzc2V0cy9ub2Z1ZWwud2F2JywgMSlcbiAgfVxufTtcblxuZHJhd2FibGVzLnB1c2gobGFuZGVyKTtcbnRpY2tpbmcucHVzaChsYW5kZXIpO1xuXG4vLyBHYW1lIGxvb3BcbmxldCBsYXN0VGltZTogbnVtYmVyID0gMDtcbmZ1bmN0aW9uIGxvb3AoY3VycmVudFRpbWU6IG51bWJlcikge1xuICBjb25zdCBkZWx0YSA9IGN1cnJlbnRUaW1lIC0gbGFzdFRpbWU7XG4gIGxhc3RUaW1lID0gY3VycmVudFRpbWU7XG5cbiAgdXBkYXRlKGRlbHRhIC8gMTAwMCwgZ2xvYmFsU3RhdGUpO1xuICBkcmF3KGdsb2JhbFN0YXRlKTtcblxuICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUobG9vcCk7XG59XG5cbmZ1bmN0aW9uIHVwZGF0ZShkZWx0YTogbnVtYmVyLCBnbG9iYWxTdGF0ZTogR2xvYmFsU3RhdGUpIHtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aWNraW5nLmxlbmd0aDsgaSsrKSB7XG4gICAgdGlja2luZ1tpXS51cGRhdGUoZGVsdGEsIGdsb2JhbFN0YXRlKTtcbiAgfVxufVxuXG5sZXQgZnVlbFBvc2l0aW9uID0gbmV3IFZlY3RvcjIoNSwgNSk7XG5sZXQgYW5nbGVQb3NpdGlvbiA9IG5ldyBWZWN0b3IyKDUsIDcuNSk7XG5sZXQgdmVsb2NpdHlQb3NpdGlvbiA9IG5ldyBWZWN0b3IyKDUsIDEwKTtcbmZ1bmN0aW9uIGRyYXcoZ2xvYmFsU3RhdGU6IEdsb2JhbFN0YXRlKSB7XG4gIGNvbnRleHQuY2xlYXJSZWN0KDAsIDAsIG1heENvb3JkLCBtYXhDb29yZCk7XG4gIGRyYXdUZXJyYWluKGNvbnRleHQsIHRlcnJhaW4sIHZjcyk7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgZHJhd2FibGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgZHJhd2FibGVzW2ldLmRyYXcoY29udGV4dCwgZ2xvYmFsU3RhdGUsIHZjcyk7XG4gIH1cbiAgZHJhd1RleHQoY29udGV4dCk7XG59XG5cbmZ1bmN0aW9uIGRyYXdUZXh0KGNvbnRleHQ6IENhbnZhc1JlbmRlcmluZ0NvbnRleHQyRCkge1xuICBsZXQgZm9udFNpemUgPSB2Y3MudHJhbnNsYXRlVmFsdWVYKDIpO1xuICBjb250ZXh0LmZvbnQgPSBgJHtmb250U2l6ZX1weCBBcmlhbGA7XG5cbiAgLy8gRnVlbFxuICBsZXQgZnVlbCA9IGdsb2JhbFN0YXRlLmxhbmRlci5mdWVsO1xuICBpZiAoZnVlbCA+IDApIHtcbiAgICBjb250ZXh0LmZpbGxTdHlsZSA9IFwiIzAwZmYwMFwiO1xuICB9IGVsc2Uge1xuICAgIGNvbnRleHQuZmlsbFN0eWxlID0gXCIjZmZmZmZmXCI7XG4gIH1cbiAgbGV0IGFkanVzdGVkRnVlbFBvc2l0aW9uID0gdmNzLnRyYW5zbGF0ZShmdWVsUG9zaXRpb24pO1xuICBjb250ZXh0LmZpbGxUZXh0KFxuICAgIGBGdWVsOiAke2Z1ZWwudG9GaXhlZCgyKX1MYCxcbiAgICBhZGp1c3RlZEZ1ZWxQb3NpdGlvbi54LFxuICAgIGFkanVzdGVkRnVlbFBvc2l0aW9uLnlcbiAgKTtcblxuICAvLyBBbmdsZVxuICBsZXQgYW5nbGUgPSBnbG9iYWxTdGF0ZS5sYW5kZXIucm90YXRpb247XG4gIGlmIChhbmdsZSA8IDUgfHwgYW5nbGUgPiAzNTUpIHtcbiAgICBjb250ZXh0LmZpbGxTdHlsZSA9IFwiIzAwZmYwMFwiO1xuICB9IGVsc2Uge1xuICAgIGNvbnRleHQuZmlsbFN0eWxlID0gXCIjZmZmZmZmXCI7XG4gIH1cbiAgbGV0IGFkanVzdGVkQW5nbGVQb3NpdGlvbiA9IHZjcy50cmFuc2xhdGUoYW5nbGVQb3NpdGlvbik7XG4gIGNvbnRleHQuZmlsbFRleHQoXG4gICAgYEFuZ2xlOiAke2FuZ2xlLnRvRml4ZWQoMil9wrBgLFxuICAgIGFkanVzdGVkQW5nbGVQb3NpdGlvbi54LFxuICAgIGFkanVzdGVkQW5nbGVQb3NpdGlvbi55XG4gICk7XG5cbiAgLy8gVmVsb2NpdHlcbiAgbGV0IG1hZ24gPSBnbG9iYWxTdGF0ZS5sYW5kZXIudmVsb2NpdHkubWFnbml0dWRlKCk7XG4gIGlmIChtYWduIDwgMikge1xuICAgIGNvbnRleHQuZmlsbFN0eWxlID0gXCIjMDBmZjAwXCI7XG4gIH0gZWxzZSB7XG4gICAgY29udGV4dC5maWxsU3R5bGUgPSBcIiNmZmZmZmZcIjtcbiAgfVxuICBsZXQgYWRqdXN0ZWRWZWxvY2l0eVBvc2l0aW9uID0gdmNzLnRyYW5zbGF0ZSh2ZWxvY2l0eVBvc2l0aW9uKTtcbiAgY29udGV4dC5maWxsVGV4dChcbiAgICBgVmVsb2NpdHk6ICR7bWFnbi50b0ZpeGVkKDIpfSBtL3NgLFxuICAgIGFkanVzdGVkVmVsb2NpdHlQb3NpdGlvbi54LFxuICAgIGFkanVzdGVkVmVsb2NpdHlQb3NpdGlvbi55XG4gICk7XG4gIGNvbnRleHQuZmlsbFN0eWxlID0gXCIjZmZmZmZmXCI7XG59XG5cbnJlcXVlc3RBbmltYXRpb25GcmFtZShsb29wKTtcbiJdLCJzb3VyY2VSb290IjoiIn0=